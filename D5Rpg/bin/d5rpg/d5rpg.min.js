var d5power;!function(t){var i=function(){function i(t){void 0===t&&(t=null),this.interval=0,this._lastTimeEvaluated=0,this.precondition=t}var e=__define,s=i;return p=s.prototype,e(p,"children",function(){return this._children}),p.Activate=function(){if(!this.activated){if(null!=this.precondition&&this.precondition.Activate(),null!=this._children)for(var t,i=0;i<this._children.length;i++)t=this._children[i],t.Activate();this.activated=!0}},p.Evaluate=function(){var t=this.CheckTimer();return this.activated&&t&&(null==this.precondition||this.precondition.Check())&&this.DoEvaluate()},p.DoEvaluate=function(){return!0},p.Tick=function(){return t.BTConst.BTResult_Ended},p.Clear=function(){},p.AddChild=function(t){null==this._children&&(this._children=new Array),null!=t&&this._children.push(t)},p.RemoveChild=function(t){if(null!=this._children&&null!=t){var i=this._children.indexOf(t);this._children.splice(i,1)}},p.CheckTimer=function(){return egret.getTimer()-this._lastTimeEvaluated>this.interval?(this._lastTimeEvaluated=egret.getTimer(),!0):!1},i}();t.BTNode=i,egret.registerClass(i,"d5power.BTNode")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(e){void 0===e&&(e=null),i.call(this,e),this._status=t.BTConst.BTActionStatus_Ready}__extends(e,i);var s=(__define,e);return p=s.prototype,p.Enter=function(){},p.Exit=function(){},p.Execute=function(){return t.BTConst.BTResult_Running},p.Clear=function(){this._status!=t.BTConst.BTActionStatus_Ready&&(this.Exit(),this._status=t.BTConst.BTActionStatus_Ready)},p.Tick=function(){var i=t.BTConst.BTResult_Ended;return this._status==t.BTConst.BTActionStatus_Ready&&(this.Enter(),this._status=t.BTConst.BTActionStatus_Running),this._status==t.BTConst.BTActionStatus_Running&&(i=this.Execute(),i!=t.BTConst.BTResult_Running&&(this.Exit(),this._status=t.BTConst.BTActionStatus_Ready)),i},p.AddChild=function(){},p.RemoveChild=function(){},e}(t.BTNode);t.BTAction=i,egret.registerClass(i,"d5power.BTAction")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,t.BTResult_Ended=1,t.BTResult_Running=2,t.BTActionStatus_Ready=1,t.BTActionStatus_Running=2,t.Parallel_And=1,t.Parallel_Or=2,t}();t.BTConst=i,egret.registerClass(i,"d5power.BTConst")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(t,e){void 0===e&&(e=null),this._type=t,i.call(this,e)}__extends(e,i);var s=(__define,e);return p=s.prototype,p.DoEvaluate=function(){for(var t,i=0;i<this.children.length;i++)if(t=this.children[i],!t.Evaluate())return!1;return!0},p.Tick=function(){for(var i=0,e=0;e<this.children.length;e++)if(this._type==t.BTConst.Parallel_And)this._results[e]==t.BTConst.BTResult_Running&&(this._results[e]=this.children[e].Tick()),this._results[e]!=t.BTConst.BTResult_Running&&i++;else if(this._results[e]==t.BTConst.BTResult_Running&&(this._results[e]=this.children[e].Tick()),this._results[e]!=t.BTConst.BTResult_Running)return this.ResetResults(),t.BTConst.BTResult_Ended;return i==this.children.length?(this.ResetResults(),t.BTConst.BTResult_Ended):t.BTConst.BTResult_Running},p.Clear=function(){this.ResetResults();for(var t,i=0;i<this.children.length;i++)t=this.children[i],t.Clear()},p.AddChild=function(e){i.prototype.AddChild.call(this,e),this._results.push(t.BTConst.BTResult_Running)},p.RemoveChild=function(t){var e=this._children.indexOf(t);this._results.splice(e,1),i.prototype.RemoveChild.call(this,t)},p.ResetResults=function(){for(var i=0;i<this._results.length;i++)this._results[i]=t.BTConst.BTResult_Running},e}(t.BTNode);t.BTParallel=i,egret.registerClass(i,"d5power.BTParallel")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(t){void 0===t&&(t=null),i.call(this,t),this._activeList=[]}__extends(e,i);var s=(__define,e);return p=s.prototype,p.DoEvaluate=function(){for(var t=0,i=0;i<this.children.length;i++){var e=this.children[i];e.Evaluate()?(this._activeList[i]=!0,t++):this._activeList[i]=!1}return 0==t?!1:!0},p.Tick=function(){for(var i=0,e=0;e<this._children.length;e++){var s=this._activeList[e];if(s){var n=this._children[e].Tick();n==t.BTConst.BTResult_Running&&i++}}return 0==i?t.BTConst.BTResult_Ended:t.BTConst.BTResult_Running},p.AddChild=function(t){i.prototype.AddChild.call(this,t),this._activeList.push(!1)},p.RemoveChild=function(t){var e=this._children.indexOf(t);this._activeList.splice(e,1),i.prototype.RemoveChild.call(this,t)},p.Clear=function(){i.prototype.Clear.call(this);for(var t,e=0;e<this.children.length;e++)t=this.children[e],t.Clear()},e}(t.BTNode);t.BTParallelFlexible=i,egret.registerClass(i,"d5power.BTParallelFlexible")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(){i.call(this,null)}__extends(e,i);var s=(__define,e);return p=s.prototype,p.Check=function(){return!0},p.Tick=function(){var i=this.Check();return i?t.BTConst.BTResult_Ended:t.BTConst.BTResult_Running},e}(t.BTNode);t.BTPrecondition=i,egret.registerClass(i,"d5power.BTPrecondition")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(t){void 0===t&&(t=null),i.call(this,t)}__extends(e,i);var s=(__define,e);return p=s.prototype,p.DoEvaluate=function(){for(var t,i=0;i<this.children.length;i++)if(t=this.children[i],t.Evaluate())return null!=this._activeChild&&this._activeChild!=t&&this._activeChild.Clear(),this._activeChild=t,!0;return null!=this._activeChild&&(this._activeChild.Clear(),this._activeChild=null),!1},p.Clear=function(){null!=this._activeChild&&(this._activeChild.Clear(),this._activeChild=null)},p.Tick=function(){if(null==this._activeChild)return t.BTConst.BTResult_Ended;var i=this._activeChild.Tick();return i!=t.BTConst.BTResult_Running&&(this._activeChild.Clear(),this._activeChild=null),i},e}(t.BTNode);t.BTPrioritySelector=i,egret.registerClass(i,"d5power.BTPrioritySelector")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(t){void 0===t&&(t=null),i.call(this,t),this._activeIndex=-1}__extends(e,i);var s=(__define,e);return p=s.prototype,p.DoEvaluate=function(){if(null!=this._activeChild){var t=this._activeChild.Evaluate();return t||(this._activeChild.Clear(),this._activeChild=null,this._activeIndex=-1),t}return this.children[0].Evaluate()},p.Tick=function(){null==this._activeChild&&(this._activeChild=this.children[0],this._activeIndex=0);var i=this._activeChild.Tick();return i==t.BTConst.BTResult_Ended&&(this._activeIndex++,this._activeIndex>=this.children.length?(this._activeChild.Clear(),this._activeChild=null,this._activeIndex=-1):(this._activeChild.Clear(),this._activeChild=this.children[this._activeIndex],i=t.BTConst.BTResult_Running)),i},p.Clear=function(){null!=this._activeChild&&(this._activeChild=null,this._activeIndex=-1);for(var t,i=0;i<this.children.length;i++)t=this.children[i],t.Clear()},e}(t.BTNode);t.BTSequence=i,egret.registerClass(i,"d5power.BTSequence")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this._root=null,this.isRunning=!0}var i=(__define,t);return p=i.prototype,p.start=function(){this.Init(),this._root.Activate()},p.Update=function(){this.isRunning&&this._root.Evaluate()&&this._root.Tick()},p.OnDestroy=function(){null!=this._root&&this._root.Clear()},p.Init=function(){},p.Reset=function(){null!=this._root&&this._root.Clear()},t.RESET="Rest",t}();t.BTTree=i,egret.registerClass(i,"d5power.BTTree")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(){}var e=(__define,i);return p=e.prototype,i.getInstance=function(t){return null==i._me&&(i._me=new i),i._me._target=t,i._me.setupListener(),i._me},p.pause=function(){this._isPause=!0},p.start=function(){this._isPause=!1},p.setupListener=function(){t.D5Game.me.touchReciver.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},p.unsetupListener=function(){t.D5Game.me.touchReciver.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},p.run=function(){if(null!=this._path&&null!=this._path[this._step]){this._target.action==t.Actions.Wait&&this._target.setAction(t.Actions.Run),this._nextTarget=this._step==this._path.length?this._endTarget:t.D5Game.me.map.tile2WorldPostion(this._path[this._step][0],this._path[this._step][1]);var i=t.GMath.getPointAngle(this._nextTarget.x-this._target.posX,this._nextTarget.y-this._target.posY),e=t.GMath.R2A(i)+90,s=!1,n=!1,r=this._target.speed*Math.cos(i),a=this._target.speed*Math.sin(i);Math.abs(this._target.posX-this._nextTarget.x)<=r&&(s=!0,r=0),Math.abs(this._target.posY-this._nextTarget.y)<=a&&(n=!0,a=0),this._target.setPos(this._target.posX+r,this._target.posY+a),s&&n?(this._step++,this._step>=this._path.length&&(this._target.setAction(t.Actions.Wait),this._path=null,this._step=1,null!=this._onWalkComplate&&this._onWalkComplate.apply(this._onWalkComplateThisObj,this._onWalkComplateParams),this.clearWalkComplate())):this.changeDirectionByAngle(e)}},p.changeDirectionByAngle=function(i){void 0===i&&(i=0),null!=this._target&&(-22.5>i&&(i+=360),this._target.setDirection(i>=-22.5&&22.5>i?t.Direction.Up:i>=22.5&&67.5>i?t.Direction.RightUp:i>=67.5&&112.5>i?t.Direction.Right:i>=112.5&&157.5>i?t.Direction.RightDown:i>=157.5&&202.5>i?t.Direction.Down:i>=202.5&&247.5>i?t.Direction.LeftDown:i>=247.5&&292.5>i?t.Direction.Left:t.Direction.LeftUp))},p.dispose=function(){this.unsetupListener(),this._path=null,this._endTarget=null,this._step=1,this._target=null,this._nextTarget=null,this.clearWalkComplate()},p.clearPath=function(){},p.setComplateFun=function(t,i){void 0===i&&(i=null);for(var e=[],s=2;s<arguments.length;s++)e[s-2]=arguments[s];this._onWalkComplate=t,this._onWalkComplateThisObj=i,this._onWalkComplateParams=e},p.onTouch=function(i){if(!this._isPause){var e=t.D5Game.me.getClicker(i.stageX,i.stageY);if(null!=e)return void this.clickSomeBody(e);this._endTarget=t.D5Game.me.map.getWorldPostion(i.stageX,i.stageY).clone(),this.clearWalkComplate(),this.walk2Target()}},p.walkTo=function(t,i){this._endTarget=new egret.Point(t,i),this.clearWalkComplate(),this.walk2Target()},p.clearWalkComplate=function(){this._onWalkComplate=null,this._onWalkComplateParams=null,this._onWalkComplateThisObj=null},p.walk2Target=function(){if(this._endTarget.x==this._target.posX&&this._endTarget.y==this._target.posY)return!1;var i=t.D5Game.me.map.Postion2Tile(this._endTarget.x,this._endTarget.y).clone(),e=t.D5Game.me.map.Postion2Tile(this._target.posX,this._target.posY);if(this._path=new Array,t.D5Game.me.g&&!t.D5Game.me.map.getRoadPass(i.x,i.y))return this._path=[[i.x,i.y],[e.x,e.y]],this._step=1,this._target.inG=!0,this._target.speedY=3,!0;if(!t.D5Game.me.map.getRoadPass(i.x,i.y))return this._target.setAction(t.Actions.Wait),!1;var s=t.D5Game.me.map.find(e.x,e.y,i.x,i.y);if(null==s)return!1;for(var n=0,r=s.length;r>n;n++)this._path.push([s[n].x,s[n].y]);return this._step=1,this.tellServerMove(this._endTarget),!0},p.tellServerMove=function(){this.checkQuiteFight(),t.D5Game.me.canclePickup()},p.checkQuiteFight=function(){null!=this._target.displayer.target&&t.D5Game.me.fightController.quitFight(this._target.displayer)},p.clickSomeBody=function(e){if(e!=this._target&&egret.Point.distance(e.$pos,this._target.$pos)>i.TALK_DISTANCE){this.clearWalkComplate();var s=t.D5Game.me.map.getPointAround(e.$pos,this._target.$pos,i.TALK_DISTANCE);return void(null==s?alert("无法接近，请靠近一些"):(this._endTarget=s,this.walk2Target(),this.setComplateFun(this.clickSomeBody,this,e)))}var n=t.GMath.getPointAngle(e.posX-this._target.posX,e.posY-this._target.posY);return this.changeDirectionByAngle(t.GMath.R2A(n)+90),e.work==t.GOData.WORK_MONSTER?void t.D5Game.me.fightController.joinFight(this._target.displayer,e.displayer):(e.job_type==t.GOData.JOB_COLLECTION?(trace("采集中。。。"),t.D5Game.me.collectionWithNPC(e)):t.D5Game.me.talkWithNPC(e),void console.log("[CharacterController] Cick Some body"))},p.getNeer=function(i,e,s,n,r,a){this._target.setAction(t.Actions.Wait);var o=t.D5Game.me.map.Postion2Tile(this._target.posX,this._target.posY).clone(),h=t.D5Game.me.map.Postion2Tile(i,e),l=t.D5Game.me.map.find(o.x,o.y,h.x,h.y);if(null!=l){this.clearWalkComplate(),this._onWalkComplate=s,this._onWalkComplateThisObj=n,this._onWalkComplateParams=[r,a],this._path=new Array;var p;for(p=0;p<l.length;p++)this._path.push([l[p].x,l[p].y]);this._step=1}},p.error=function(){throw new Error("[CharacterController] please just get instance throw static function getInstance()")},i.TALK_DISTANCE=200,i}();t.CharacterController=i,egret.registerClass(i,"d5power.CharacterController",["d5power.IController"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,t.RELIVE=-1,t.Stop=8,t.Run=1,t.Attack=2,t.BowAtk=3,t.Sit=4,t.Die=5,t.Pickup=6,t.BeAtk=7,t.Wait=8,t}();t.Actions=i,egret.registerClass(i,"d5power.Actions")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(t,e){this._pickupTime=5,null!=i.my&&this.D5error(),i._my=this,this._parent=e,this._onComplate=t,this._baseitemList=new Object,this._baseskillList=new Object,this._monsterConf=new Object,this._npcList=new Object,this._jobList=new Object,this._userProList=new Object,this._userLvList=new Object,this._missionLib=new Object,this._missionList=new Object,this._chapterList=new Object,this.loadConfigCenter()}var e=__define,s=i;return p=s.prototype,e(p,"pickupTime",function(){return this._pickupTime}),e(i,"my",function(){return i._my}),p.loadConfigCenter=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoadComplete,this),RES.loadGroup("configcenter")},p.onLoadComplete=function(t){"configcenter"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoadComplete,this),this.parseData())},p.parseData=function(){this.parseBaseItemList(),this.parseBaseSkillList(),this.parseNpcList(),this.parseMonsterConfigList(),this.parseJobList(),this.parseMissionLib(),this.parseMissionList(),this._onComplate.apply(this._parent)},p.parseMissionLib=function(){for(var i,e=RES.getRes("missionLib"),s=e.mission,n=s.length,r=0;n>r;r++){i=s[r];var a=new t.MissionData;a.formatFromJson(i),this._missionLib[a.id]=a}},p.getMissionData=function(t){return this._missionLib.hasOwnProperty(t.toString())?this._missionLib[t]:null},p.parseMissionList=function(){var i=RES.getRes("chapter"),e=i.chapter,s=e.length;this.maxChapter=s;for(var n,i,r,a=0;s>a;a++){n=e[a];var o=new t.ChapterData;o.id=parseInt(n.id),o.add=n.add,o.info=n.info;for(var h=0;h<n.section.length;h++){i=n.section[h];var l=new t.PartData;if(l.id=parseInt(i.id),i.tree){l.tree.startId=parseInt(i.tree.startId);for(var p=0;p<i.tree.tree.length;p++){r=i.tree.tree[p];var _=new t.MissionNode;_.chapterId=o.id,_.partId=l.id,_.format(r),this._missionList[_.chapterId+"_"+_.partId+"_"+_.id]=_}}o.partArray.push(l)}this._chapterList[o.id]=o}},p.getChapterData=function(t){return this._chapterList.hasOwnProperty(t.toString())?this._chapterList[t]:null},p.getMissionNode=function(t,i,e){return this._missionList.hasOwnProperty(t+"_"+i+"_"+e)?this._missionList[t+"_"+i+"_"+e]:null},p.parseNpcList=function(){for(var i,e=RES.getRes("npcConfig"),s=e.npc,n=s.length,r=0;n>r;r++){i=s[r];var a=new t.NpcData;a.format(i),this._npcList[a.id]=a}},p.getNpcConf=function(t){return this._npcList.hasOwnProperty(t.toString())?this._npcList[t]:null},p.parseMonsterConfigList=function(){for(var i,e=RES.getRes("monsterConfig"),s=e.monster,n=s.length,r=0;n>r;r++){i=s[r];var a=new t.MonsterConfData;a.format(i),this._monsterConf[a.id]=a}},p.getMonsterConf=function(t){return this._monsterConf.hasOwnProperty(t.toString())?this._monsterConf[t]:null},p.parseUserProList=function(){for(var i,e=RES.getRes("userProConfig"),s=e.data,n=s.length,r=0;n>r;r++){i=s[r];var a=new t.UserProData;a.format(i),this._userProList[a.field]=a}},p.getUserproConfig=function(t){return this._userProList[t]},p.parseJobList=function(){for(var i,e=RES.getRes("jobConfig"),s=e.job,n=s.length,r=0;n>r;r++){i=s[r];var a=new t.JobData;a.format(i),this._jobList[a.id]=a}},p.getJobType=function(t){return this._jobList.hasOwnProperty(t.toString())?this._jobList[t]:null},p.parseBaseSkillList=function(){for(var i,e=RES.getRes("skillConfig"),s=e.skill,n=s.length,r=0;n>r;r++){i=s[r];var a=new t.BaseSkillData;a.baseFormat(i),this._baseskillList[a.id]=a}this.parseSkillList()},p.parseSkillList=function(){},p.getBaseSkillData=function(t){return this._baseskillList[t]},e(p,"baseskillList",function(){return this._baseskillList}),p.parseBaseItemList=function(){for(var i,e=RES.getRes("itemConfig"),s=e.item,n=s.length,r=0;n>r;r++){i=s[r];var a=new t.BaseItemData;a.baseFormat(i),this._baseitemList[a.id]=a}this.parseItemList()},p.parseItemList=function(){},p.getBaseItemData=function(t){return this._baseitemList[t]},p.getBaseItemList=function(){return this._baseitemList},p.D5error=function(){throw new Error("[D5ConfigCenter] Please get instance by (get me) function.")},i}();t.D5ConfigCenter=i,egret.registerClass(i,"d5power.D5ConfigCenter")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,t.Down=0,t.LeftDown=1,t.Left=2,t.LeftUp=3,t.Up=4,t.RightUp=5,t.Right=6,t.RightDown=7,t}();t.Direction=i,egret.registerClass(i,"d5power.Direction")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,t.getPointAngle=function(t,i){return Math.atan2(i,t)},t.R2A=function(t){return 180*t/Math.PI},t.A2R=function(t){return void 0===t&&(t=0),t*Math.PI/180},t}();t.GMath=i,egret.registerClass(i,"d5power.GMath")}(d5power||(d5power={}));var Layer=function(t){function i(){t.call(this)}__extends(i,t);var e=(__define,i);return p=e.prototype,i}(egret.DisplayObjectContainer);egret.registerClass(Layer,"Layer");var d5power;!function(t){var i=function(){function t(t){void 0===t&&(t=0),this._type=0,this._type=t}var i=__define,e=t;return p=e.prototype,i(p,"type",function(){return this._type}),p.addCommand=function(t){null==this._commandList&&(this._commandList=[]),this._commandList.push(t)},i(p,"command",function(){return this._command},function(t){this._command=t}),i(p,"commandList",function(){return this._commandList}),i(p,"params",function(){return this._params},function(t){this._params=t}),p.toString=function(){var t="[D5ScriptCommand] type:"+this._type+",command:"+this._command+",params:["+this._params+"],sonCommand:";if(null!=this._commandList)for(var i=this._commandList.length,e=0;i>e;e++){this._commandList[e]}return t},t.COMMAND=0,t.IF=1,t.SWITCH=2,t.FOR=3,t.WAITFOR=4,t}();t.D5ScriptCommand=i,egret.registerClass(i,"d5power.D5ScriptCommand")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(t){this._runSpeed=500,this._lastRunTime=0,this._break=!1,this._lineno=0,this._running=!1,this._runLine=0,this.stage=t}var e=(__define,i);return p=e.prototype,p.number=function(t,e){void 0===e&&(e=0),i._vars[t]=e},p.string=function(t,e){i._vars[t]=e},p.add=function(t){i._vars[t]?i._vars[t]++:trace("[D5ScriptParser] Please define "+t+" first.")},p.print=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var s=0;s<t.length;s++){var n=t[s];i._vars[n]&&(t[s]=i._vars[n])}trace(t)},p.wait=function(t){void 0===t&&(t=0),this._lastRunTime=egret.getTimer()+1e3*t,trace("[Wait]")},p["goto"]=function(t){if(void 0===t&&(t=0),t-=1,0>t&&(t=0),t>=this._command.commandList.length)throw new Error("[D5ScriptParser] can not jump to a not exist line,line no. is "+t+",total line is "+this._command.commandList.length);this._runLine=t-1},p.jump=function(t){void 0===t&&(t=0);var i=this._runLine+t;if(i>=this._command.commandList.length||0>i)throw new Error("[D5ScriptParser] can not jump to a not exist line,line no. is "+i+",total line is "+this._command.commandList.length);this._runLine=i-1},p.runScript=function(e){if(void 0===e&&(e=""),this._running)return void(null!=i._noticer&&i._noticer.notice("当前正有一个脚本运行，目前不支持多脚本运行"));if(this._nowUrl!=e&&""!=e)return this._command=null,this._nowUrl=e,void RES.getResByUrl(e,this.onComplate,this);if(null!=this._command){if(this._break=!1,null==this.stage)throw new Error("[D5ScriptParser] can not run without stage setted.please set stage first.");this.start()}else this._runLine=0,this._lineno=0,this._command=new t.D5ScriptCommand,this.Parse(this._command),this.runScript()},p.configTxt=function(t){var i;i=/\t/g,t=t.replace(i,""),i=/\r/g,t=t.replace(i,"\n"),i=/\r\n/g,t=t.replace(i,"\n"),i=/\n/g;var e=t.split(i);this._scriptArr=new Array;for(var s=e.length,n=0;s>n;n++){var r=e[n];"#"!=r.substr(0,1)&&""!=r&&"\r"!=r&&"\n"!=r&&"\r\n"!=r&&this._scriptArr.push(r)}this.runScript()},p.stop=function(){this.pause(),this._lastRunTime=0,this._command=null,this._nowUrl="",this._runLine=0,this._lineno=0,this._scriptArr=[],this._break=!1},p.pause=function(){this.stage.removeEventListener(egret.Event.ENTER_FRAME,this.running,this),this._running=!1},p.start=function(){this._running||(this.stage.addEventListener(egret.Event.ENTER_FRAME,this.running,this),this._running=!0)},p.runComplate=function(){trace("[D5ScriptParser] 脚本执行完毕")},p.running=function(){if(!this._break&&egret.getTimer()-this._lastRunTime>this._runSpeed){if(this._runLine>=this._command.commandList.length)return this.stop(),void this.runComplate();var t=this._command.commandList[this._runLine];this.exec(t),this._runLine++}},p.exec=function(e){var s=!1;if(!this._break){switch(e.type){case t.D5ScriptCommand.IF:var n=e.params[0];if(this[n]&&this[n]instanceof Function){var r=e.params.length;if(1==r)s=this[n].apply(this);else{for(var a=new Array,o=1;r>o;o++)a.push(e.params[o]);s=this[n].apply(this,a),trace(s,"RUN")}}else{if(e.params.length>1)return void trace("[D5ScriptParser] No Supported IF mode.There are only support ONE chance.");var h=/^[a-zA-Z_]*\([0-9a-zA-Z,]*\)|^[a-zA-Z0-9_]*/g,l=n.match(h);if(null==l||0==l.length)return void trace("[D5ScriptParser] Can not found any command.");var p,_,c=n.split(l[0]),u=l[0],d=/>|<|!=|==|>=|<=/g,m=c[1].toString().match(d);if(0==m.length)_=c[1],p=l[0];else{if(1!=l.length)throw new Error("[D5ScriptParser] There are only support ONE runner.");var f=c[1].toString().split(m[0]);_=f[1],p=m[0]}var g=/\([0-9a-zA-Z,]*\)/g,v=u.match(g),w=u.replace(g,"");if(v&&v.length>1)throw new Error("[D5ScriptParser] Function format error.");var y;if(null==v||0==v.length)y="";else{var D=v[0];y=D.substr(1,D.length-2)}switch(""==y?this[w]?u=this[w]instanceof Function?this[w]():this[w]:i._vars[w]&&(u=i._vars[w]):this[w]&&this[w]instanceof Function&&(u=this[w].apply(this,y.split(","))),s=!0,p){case">":trace("[D5ScriptParser] Check "+u+" > "+_),parseInt(u)<=parseInt(_)&&(s=!1);break;case"<":trace("[D5ScriptParser] Check "+u+"<"+_),parseInt(u)>=parseInt(_)&&(s=!1);break;case"==":trace("[D5ScriptParser] Check "+u+"=="+_),u!=_&&(s=!1);break;case"!=":trace("[D5ScriptParser] Check "+u+"!="+_),u==_&&(s=!1);break;case">=":trace("[D5ScriptParser] Check "+u+">="+_),parseInt(u)<parseInt(_)&&(s=!1);break;case"<=":trace("[D5ScriptParser] Check "+u+"<="+_),parseInt(u)>parseInt(_)&&(s=!1);break;default:throw new Error("Can not understand your runner ")}}break;case t.D5ScriptCommand.SWITCH:for(var S=(this[e.params[0].toString()],e.commandList.length),C=0;S>C;C++){e.commandList[C]}break;case t.D5ScriptCommand.FOR:if(2!=e.params.length)throw new Error("No Supported FOR mode.There are only support TWO params.");var T=e.params[0],R=e.params[1],x=e.commandList;if(null!=x&&x.length>0)for(var o=T;R>o;o++)for(var E=x.length,I=0;E>I;I++){x[I]}break;default:if(this[e.command]&&this[e.command]instanceof Function)try{this[e.command].apply(this,e.params)}catch(M){trace("[D5ScriptParser] can not run function "+e.command+",Error code:"+M.message)}else trace("[D5ScriptParser] can not found the function "+e.command)}if(s){var k=e.commandList;if(null!=k&&k.length>0)for(var o=0;o<k.length;o++)this.exec(k[o])}}},p.Parse=function(i){void 0===i&&(i=null);for(var e,s,n=!0;n&&(e=this.D5ScriptAt(this._scriptArr),null!=e);){var r="[*string*]",a=e.replace(/\"(.*)\"/g,r);s=a.split(" ");for(var o=e.match(/\"(.*)\"/g),h=0,l=s.length-1;l>=0;l--)s[l]==r?(s[l]=o[h].replace(/\"/g,""),h++):(void 0==s[l]||""==s[l])&&s.splice(l,1);var p=null;switch(s[0]){case"if":p=new t.D5ScriptCommand(t.D5ScriptCommand.IF),this.Parse(p);break;case"endif":n=!1;break;case"switch":p=new t.D5ScriptCommand(t.D5ScriptCommand.SWITCH),this.Parse(p);break;case"endswitch":n=!1;break;case"for":p=new t.D5ScriptCommand(t.D5ScriptCommand.FOR),this.Parse(p);break;case"endfor":n=!1;break;default:p=new t.D5ScriptCommand}if(null!=p){if(p.command=s.shift(),s.length>1)throw new Error("[D5ScriptParser] Too many params.There have "+s.length+" params.content is:"+s);p.params=null==s[0]?null:s[0].toString().split(","),i.addCommand(p)}}},p.onComplate=function(t){var i=t;this.configTxt(i)},p.D5ScriptAt=function(t){var i=t[this._lineno];return this._lineno++,i},p.error=function(){throw new Error("D5ScriptParser is a single class.can not instance again.")},i._vars={},i}();t.D5ScriptParser=i,egret.registerClass(i,"d5power.D5ScriptParser")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(t,i){void 0===i&&(i=null),this._cellSize=5,this.path=new egret.Sprite,this.image=new egret.Bitmap,this.imageWrapper=new egret.DisplayObjectContainer,this.isDisplayMode=!1,null!=i?(this.isDisplayMode=!0,this.imageWrapper.addChild(this.image),i.addChild(this.imageWrapper),this.imageWrapper.addChild(this.path)):this.isDisplayMode=!1,this.makeGrid(t)}var i=__define,s=t;return p=s.prototype,i(p,"WORKMODE",void 0,function(t){if(8!=t&&4!=t)throw new Error("仅支持8方向或4方向寻路")}),p.find=function(t,i,e,s){if(e=Math.min(e,this._grid.numCols-1),s=Math.min(s,this._grid.numRows-1),e=Math.max(e,0),s=Math.max(s,0),this._grid.setEndNode(e,s),t=Math.min(t,this._grid.numCols-1),i=Math.min(i,this._grid.numRows-1),t=Math.max(t,0),i=Math.max(i,0),this._grid.setStartNode(t,i),this.isDisplayMode)var n=egret.getTimer();if(this.astar.findPath()){if(this._index=0,this.astar.floyd(),this._path=this.astar.floydPath,this.isDisplayMode){n=egret.getTimer()-n,console.log("[SilzAstar]",n+"ms   length:"+this.astar.path.length),console.log("[SilzAstar]",this.astar.floydPath),this.path.graphics.clear();for(var r=0;r<this.astar.floydPath.length;r++){var a=this.astar.floydPath[r];this.path.graphics.lineStyle(0,16711680),this.path.graphics.drawCircle((a.x+.5)*this._cellSize,(a.y+.5)*this._cellSize,2),this.path.graphics.lineStyle(0,16711680,.5),this.path.graphics.moveTo(t,i)}}return this._path}return this.isDisplayMode&&(this._grid.setEndNode(e-1,s-1),n=egret.getTimer()-n,console.log("[SilzAstar]",n+"ms 找不到")),null},p.makeGrid=function(i){var s=i.length,r=i[0].length;this._grid=new n(r,s);var a,o;for(o=0;s>o;o++)for(a=0;r>a;a++)this._grid.setWalkable(a,o,0==i[o][a]);4==t.WorkMode?this._grid.calculateLinks(1):this._grid.calculateLinks(),this.astar=new e(this._grid),this.isDisplayMode&&(this.drawGrid(),this.path.graphics.clear())},p.drawGrid=function(){console.log("fuck")},p.getColor=function(t){return t.walkable?t==this._grid.startNode?13421772:t==this._grid.endNode?13421772:16777215:0},t.WorkMode=8,t}();t.SilzAstar=i,egret.registerClass(i,"d5power.SilzAstar");var e=function(){function t(t){this._straightCost=1,this._diagCost=Math.SQRT2,this.nowversion=1,this.TwoOneTwoZero=2*Math.cos(Math.PI/3),this._grid=t,this.heuristic=this.euclidian2}var i=__define,e=t;return p=e.prototype,p.justMin=function(t,i){return t.f<i.f},p.findPath=function(){return this._endNode=this._grid.endNode,this.nowversion++,this._startNode=this._grid.startNode,this._open=new s(this.justMin),this._startNode.g=0,this.search()},p.floyd=function(){if(null!=this.path){this._floydPath=this.path.concat();var t=this._floydPath.length;if(t>2){var i=new a(0,0),e=new a(0,0);this.floydVector(i,this._floydPath[t-1],this._floydPath[t-2]);for(var s=this._floydPath.length-3;s>=0;s--)this.floydVector(e,this._floydPath[s+1],this._floydPath[s]),i.x==e.x&&i.y==e.y?this._floydPath.splice(s+1,1):(i.x=e.x,i.y=e.y)}for(t=this._floydPath.length,s=t-1;s>=0;s--)for(var n=0;s-2>=n;n++)if(this.floydCrossAble(this._floydPath[s],this._floydPath[n])){for(var r=s-1;r>n;r--)this._floydPath.splice(r,1);s=n,t=this._floydPath.length;break}}},p.floydCrossAble=function(t,i){for(var e=this.bresenhamNodes(new egret.Point(t.x,t.y),new egret.Point(i.x,i.y)),s=e.length-2;s>0;s--)if(!this._grid.getNode(e[s].x,e[s].y).walkable)return!1;return!0},p.bresenhamNodes=function(t,i){var e=Math.abs(i.y-t.y)>Math.abs(i.x-t.x);if(e){var s=t.x;t.x=t.y,t.y=s,s=i.x,i.x=i.y,i.y=s}var n=i.x>t.x?1:i.x<t.x?-1:0,r=(i.y>t.y?1:i.y<t.y?-1:0,(i.y-t.y)/Math.abs(i.x-t.x)),a=[],o=t.x+n,h=t.y+r;for(a.push(e?new egret.Point(t.y,t.x):new egret.Point(t.x,t.y));o!=i.x;){var l=Math.floor(h),p=Math.ceil(h);a.push(e?new egret.Point(l,o):new egret.Point(o,l)),l!=p&&a.push(e?new egret.Point(p,o):new egret.Point(o,p)),o+=n,h+=r}return a.push(e?new egret.Point(i.y,i.x):new egret.Point(i.x,i.y)),a},p.floydVector=function(t,i,e){t.x=i.x-e.x,t.y=i.y-e.y},p.search=function(){var t=this._startNode;for(t.version=this.nowversion;t!=this._endNode;){for(var i=t.links.length,e=0;i>e;e++){var s=t.links[e].node,n=t.links[e].cost,r=t.g+n,a=this.heuristic(s),o=r+a;s.version==this.nowversion?s.f>o&&(s.f=o,s.g=r,s.h=a,s.parent=t):(s.f=o,s.g=r,s.h=a,s.parent=t,this._open.ins(s),s.version=this.nowversion)}if(1==this._open.a.length)return!1;t=this._open.pop()}return this.buildPath(),!0},p.buildPath=function(){this._path=[];var t=this._endNode;for(this._path.push(t);t!=this._startNode;)t=t.parent,this._path.unshift(t)},i(p,"path",function(){return this._path}),i(p,"floydPath",function(){return this._floydPath}),p.manhattan=function(t){return Math.abs(t.x-this._endNode.x)+Math.abs(t.y-this._endNode.y)},p.manhattan2=function(t){var i=Math.abs(t.x-this._endNode.x),e=Math.abs(t.y-this._endNode.y);return i+e+Math.abs(i-e)/1e3},p.euclidian=function(t){var i=t.x-this._endNode.x,e=t.y-this._endNode.y;return Math.sqrt(i*i+e*e)},p.chineseCheckersEuclidian2=function(t){var i=t.y/this.TwoOneTwoZero,e=t.x+t.y/2,s=e-this._endNode.x-this._endNode.y/2,n=i-this._endNode.y/this.TwoOneTwoZero;return this.sqrt(s*s+n*n)},p.sqrt=function(t){return Math.sqrt(t)},p.euclidian2=function(t){var i=t.x-this._endNode.x,e=t.y-this._endNode.y;return i*i+e*e},p.diagonal=function(t){var i=Math.abs(t.x-this._endNode.x),e=Math.abs(t.y-this._endNode.y),s=Math.min(i,e),n=i+e;return this._diagCost*s+this._straightCost*(n-2*s)},t}();t.AStar=e,egret.registerClass(e,"d5power.AStar");var s=function(){function t(t){void 0===t&&(t=null),this.a=[],this.justMinFun=function(){return this.x<this.y},this.a.push(-1),null!=t&&(this.justMinFun=t)}var i=(__define,t);return p=i.prototype,p.ins=function(t){var i=this.a.length;this.a[i]=t;for(var e=i>>1;i>1&&this.justMinFun(this.a[i],this.a[e]);){var s=this.a[i];this.a[i]=this.a[e],this.a[e]=s,i=e,e=i>>1}},p.pop=function(){var t=this.a[1];this.a[1]=this.a[this.a.length-1],this.a.pop();for(var i=1,e=this.a.length,s=i<<1,n=s+1;e>s;){if(e>n)var r=this.justMinFun(this.a[n],this.a[s])?n:s;else r=s;if(!this.justMinFun(this.a[r],this.a[i]))break;var a=this.a[i];this.a[i]=this.a[r],this.a[r]=a,i=r,s=i<<1,n=s+1}return t},t}();t.BinaryHeap=s,egret.registerClass(s,"d5power.BinaryHeap");var n=function(){function t(t,i){this._straightCost=1,this._diagCost=Math.SQRT2,this._numCols=t,this._numRows=i,this._nodes=new Array;for(var e=0;e<this._numCols;e++){this._nodes[e]=new Array;for(var s=0;s<this._numRows;s++)this._nodes[e][s]=new a(e,s)}}var i=__define,e=t;return p=e.prototype,p.calculateLinks=function(t){void 0===t&&(t=0),this.type=t;for(var i=0;i<this._numCols;i++)for(var e=0;e<this._numRows;e++)this.initNodeLink(this._nodes[i][e],t)},p.getType=function(){return this.type},p.initNodeLink=function(t,i){var e=Math.max(0,t.x-1),s=Math.min(this.numCols-1,t.x+1),n=Math.max(0,t.y-1),a=Math.min(this.numRows-1,t.y+1);t.links=[];for(var o=e;s>=o;o++)for(var h=n;a>=h;h++){var l=this.getNode(o,h);if(l!=t&&l.walkable){if(2!=i&&o!=t.x&&h!=t.y){var p=this.getNode(t.x,h);
if(!p.walkable)continue;if(p=this.getNode(o,t.y),!p.walkable)continue}var _=this._straightCost;if(t.x!=l.x&&t.y!=l.y){if(1==i)continue;if(2==i&&(t.x-l.x)*(t.y-l.y)==1)continue;_=2==i?this._straightCost:this._diagCost}t.links.push(new r(l,_))}}},p.getNode=function(t,i){return this._nodes[t][i]},p.setEndNode=function(t,i){this._endNode=this._nodes[t][i]},p.setStartNode=function(t,i){this._startNode=this._nodes[t][i]},p.setWalkable=function(t,i,e){this._nodes[t][i].walkable=e},i(p,"endNode",function(){return this._endNode}),i(p,"numCols",function(){return this._numCols}),i(p,"numRows",function(){return this._numRows}),i(p,"startNode",function(){return this._startNode}),t}();t.Grid=n,egret.registerClass(n,"d5power.Grid");var r=function(){function t(t,i){this.node=t,this.cost=i}var i=(__define,t);return p=i.prototype,t}();t.Link=r,egret.registerClass(r,"d5power.Link");var a=function(){function t(t,i){this.walkable=!0,this.version=1,this.x=t,this.y=i}var i=(__define,t);return p=i.prototype,p.toString=function(){return"x:"+this.x+" y:"+this.y},t}();t.SilzAstarNode=a,egret.registerClass(a,"d5power.SilzAstarNode")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(t){for(var i in t)console.log(i,t[i])}var i=(__define,t);return p=i.prototype,t}();t.XML=i,egret.registerClass(i,"d5power.XML")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(){this._zorderSpeed=600,this._zeroX=0,this._zeroY=0,this._moveSpeed=1,this._moveAngle=0,null==i._cameraView&&(i._cameraView=new egret.Rectangle),this._cameraCutView=new egret.Rectangle}var e=__define,s=i;return p=s.prototype,e(i,"needreCut",function(){return i.$needreCut}),e(p,"zeroX",function(){return isNaN(this._zeroX)?0:this._zeroX}),e(p,"zeroY",function(){return isNaN(this._zeroY)?0:this._zeroY}),p.setZero=function(i,e){this._zeroX=i,this._zeroY=e;var s=t.D5Game.me.map.width-t.D5Game.me.screenWidth;this._zeroX=this._zeroX<0?0:this._zeroX,this._zeroX=this._zeroX>s?s:this._zeroX,s=t.D5Game.me.map.height-t.D5Game.me.screenHeight,this._zeroY=this._zeroY<0?0:this._zeroY,this._zeroY=this._zeroY>s?s:this._zeroY},p.update=function(){if(this._focus){this._zeroX=this._focus.posX-(t.D5Game.me.screenWidth>>1),this._zeroY=this._focus.posY-(t.D5Game.me.screenHeight>>1);var e=t.D5Game.me.map.width-t.D5Game.me.screenWidth;this._zeroX=this._zeroX<0?0:this._zeroX,this._zeroX=this._zeroX>e?e:this._zeroX,e=t.D5Game.me.map.height-t.D5Game.me.screenHeight,this._zeroY=this._zeroY<0?0:this._zeroY,this._zeroY=this._zeroY>e?e:this._zeroY}i._cameraView.x=this._zeroX,i._cameraView.y=this._zeroY,i._cameraView.width=t.D5Game.me.screenWidth,i._cameraView.height=t.D5Game.me.screenHeight},p.setFocus=function(t){this._focus=t,this.update(),this.reCut()},e(p,"focus",function(){return this._focus}),e(p,"moveSpeed",void 0,function(t){this._moveSpeed=t}),e(i,"cameraView",function(){return i._cameraView}),e(p,"cameraCutView",function(){var i=this._zeroX,e=this._zeroY;return i>0&&(i-=2*t.D5Game.me.map.tileWidth),i>0&&(e-=e-2*t.D5Game.me.map.tileHeight),i=0>i?0:i,e=0>e?0:e,this._cameraCutView.x=i,this._cameraCutView.y=e,this._cameraCutView.width=t.D5Game.me.screenWidth+2*t.D5Game.me.map.tileWidth,this._cameraCutView.height=t.D5Game.me.screenHeight+2*t.D5Game.me.map.tileHeight,this._cameraCutView}),p.moveNorth=function(t){void 0===t&&(t=1),0!=this._moveSpeed&&0!=this._zeroY&&(this.setFocus(null),this.setZero(this._zeroX,this._zeroY-this._moveSpeed*t),this.reCut())},p.moveSourth=function(t){void 0===t&&(t=1),0!=this._moveSpeed&&(this.setFocus(null),this.setZero(this._zeroX,this._zeroY+this._moveSpeed*t),this.reCut())},p.moveWest=function(t){void 0===t&&(t=1),0!=this._moveSpeed&&0!=this._zeroX&&(this.setFocus(null),this.setZero(this._zeroX-this._moveSpeed*t,this._zeroY),this.reCut())},p.moveEast=function(t){void 0===t&&(t=1),0!=this._moveSpeed&&(this.setFocus(null),this.setZero(this._zeroX+this._moveSpeed*t,this._zeroY),this.reCut())},p.move=function(t,i,e){void 0===e&&(e=1),this.setFocus(null),this.setZero(this._zeroX+this._moveSpeed*t*e,this._zeroY+this._moveSpeed*i*e),this.reCut()},p.lookAt=function(i,e){this.setFocus(null),this.setZero(i-(t.D5Game.me.screenWidth>>1),e-(t.D5Game.me.screenHeight>>1)),this.reCut()},p.flyTo=function(i,e,s){return void 0===s&&(s=null),null!=this._timer?void console.log("[D5Camera] Camera is moving,can not do this operation."):(this.setFocus(null),this._moveCallBack=s,this._moveStart=new egret.Point(this._zeroX-(t.D5Game.me.screenWidth>>1),this._zeroY-(t.D5Game.me.screenHeight>>1)),this._moveEnd=new egret.Point(i-(t.D5Game.me.screenWidth>>1),e-(t.D5Game.me.screenHeight>>1)),this._timer=new egret.Timer(50),this._timer.addEventListener(egret.TimerEvent.TIMER,this.moveCamera,this),void this._timer.start())},p.moveCamera=function(){var t=(this._moveEnd.x-this._moveStart.x)/5,i=(this._moveEnd.y-this._moveStart.y)/5;this._moveStart.x+=t,this._moveStart.y+=i,this.setZero(this._moveStart.x,this._moveStart.y),t>-.5&&.5>t&&i>-.5&&.5>i&&(this._moveEnd=null,this._timer.stop(),this._timer.removeEventListener(egret.TimerEvent.TIMER,this.moveCamera,this),this._timer=null,this.reCut(),null!=this._moveCallBack&&this._moveCallBack())},e(p,"zorderSpeed",function(){return this._zorderSpeed}),p.reCut=function(){for(var e,s,n=t.D5Game.me.dataList,r=n.length,a=0;r>a;a++)e=n[a],e!=t.D5Game.me.player&&(s=i.cameraView.containsPoint(e.$pos),!e.inScreen&&s?t.D5Game.me.add2Screen(e):e.inScreen&&!s&&t.D5Game.me.remove4Screen(e))},i.RenderMaxTime=10,i}();t.D5Camera=i,egret.registerClass(i,"d5power.D5Camera",["d5power.ICamera"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(s,n,r,a){void 0===a&&(a=null),i.call(this),this._lastZorder=0,this._firstEnter=!0,e._me&&this.error(),this.touchEnabled=!0,e._me=this,this._runAction=this.run,this._startX=n,this._startY=r,this.buildMap(s),this._readyBack=a,this._camera=new t.D5Camera,this._container_map=new Layer,this._container=new Layer,this._container_far=new Layer,this._container_bottom=new Layer,this._container_top=new Layer,this._touch_layer=new egret.Sprite,this._touch_layer.touchEnabled=!0,this.addChild(this._container_map),this.addChild(this._container_far),this.addChild(this._container_bottom),this.addChild(this._container),this.addChild(this._container_top),this.addChild(this._touch_layer),this._dataList=[],this._screenList=[],this.addEventListener(egret.Event.ADDED_TO_STAGE,this.install,this);var o=this;document.addEventListener("keydown",function(t){o._g&&32==t.keyCode&&(o.player.inG=!0,o.player.speedY=-20)})}__extends(e,i);var s=__define,n=e;return p=n.prototype,s(e,"me",function(){return e._me}),p.runScript=function(){},p.openGravity=function(){this._g||(this._g=new t.D5Gravity,this._g.initGravity(.8))},s(p,"g",function(){return this._g}),p.setCharacterData=function(t){null==this._characterData&&(this._characterData=t)},p.setMissionDispatcher=function(t){null==this._missionDispatcher&&(this._missionDispatcher=t)},s(p,"missionDispatcher",function(){return this._missionDispatcher}),s(p,"characterData",function(){return this._characterData}),p.initUI=function(){},p.showPackage=function(){},p.showChapterWin=function(){},p.showMission=function(){},p.showScript=function(){},p.notice=function(i){new t.Notice(e.me.stage,i)},p.collectionWithNPC=function(){},p.pickupItem=function(){},p.canclePickup=function(){},p.pickup=function(){},p.scriptWithNPC=function(t){this.runScript(t.script)},p.talkWithNPC=function(){},p.missionDialog=function(){},p.onSelect=function(){},p.showCheckMission=function(){},p.dialog=function(t,i,e,s){void 0===s&&(s=null)},p.closeDialog=function(){},p.showNpcWindow=function(){},p.alert=function(){},s(p,"timer",function(){return this._timer}),s(p,"screenWidth",function(){return this._screenW}),s(p,"screenHeight",function(){return this._screenH}),s(p,"camera",function(){return this._camera}),s(p,"map",function(){return this._map}),s(p,"dataList",function(){return this._dataList}),s(p,"player",function(){return this._player}),p.getIGDByUid=function(t){for(var i=this._dataList,e=0;e<i.length;e++)if(i[e].uid==t)return i[e];return null},p.setPlayer=function(t){this._player=t,this.add2Screen(t)},p.addObject=function(t){this._dataList.push(t)},p.removeObject=function(t){var i=this._dataList[t];i.dispose(),this._dataList.splice(t,1)},p.getClicker=function(i,e){var s,n,r,a=new Array;for(s=0,n=this._screenList.length;n>s;s++)r=this._screenList[s],r.work!=t.GOData.WORK_DOOR&&r!=this._player&&r.displayer.hitTestArea(i,e)&&a.push(r);var o=function(t,i){return t.zOrder>i.zOrder?1:t.zOrder==i.zOrder?0:-1};return a.sort(o),a[0]},p.missionLoaded=function(){for(var t,i=0,e=this._screenList.length;e>i;i++)t=this._screenList[i],t.loadMission()},p.add2Screen=function(i){i.inScreen||(i.setInScreen(!0),console.log("[D5Game] in screen"),i.setDisplayer(i.work==t.GOData.WORK_EVENT?t.EventObject.getEvent():i.work==t.GOData.WORK_DOOR?t.DoorObject.getDoor():t.GameObject.getInstance()),this._screenList.push(i),this._container.addChild(i.displayer),i.work==t.GOData.WORK_NPC&&i.loadMission(),this._g&&this._g.addObject(i))},p.remove4Screen=function(t){if(t.setInScreen(!1),null!=t.displayer){var i=this._screenList.indexOf(t);-1!=i&&this.remove4ScreenByIndex(i)}},p.remove4ScreenByIndex=function(t){var i=this._screenList[t];this._container.contains(i.displayer)&&this._container.removeChild(i.displayer),i.setDisplayer(null),this._screenList.splice(t,1)},p.changeMap=function(t,i,e){this.reset(),this._startX=i,this._startY=e,this.enterMap(t)},p.createNPC=function(i,s,n){var r=t.GOData.getInstance();return r.setRespath(e.RES_SERVER+e.ASSET_PATH+"/mapRes/"+i),r.setDirection(t.Direction.Down),r.setNickname(s),r.setWork(t.GOData.WORK_NPC),null!=n&&r.setPos(n.x,n.y),this.addObject(r),r},p.createRoad=function(i,s){var n=t.GOData.getInstance();return n.setRespath(e.RES_SERVER+e.ASSET_PATH+"/mapRes/"+i),n.setDirection(t.Direction.Down),n.setWork(t.GOData.WORK_DOOR),null!=s&&n.setPos(s.x,s.y),this.addObject(n),n},p.setup=function(i){if(this._monsterConf=new Array,this._map.setContainer(this._container_map),this._map.setup(parseInt(i.id),parseInt(i.mapW),parseInt(i.mapH),parseInt(i.tileX),parseInt(i.tileY),this.init,this),"1"==i.gravity&&this.openGravity(),""!=i.music&&RES.getResByUrl(e.RES_SERVER+i.music,this.playMusic,this),i.far)for(var s=0;s<i.far.length;s++){var n=i.far[s];if(""!=n.far){var r=0;""!=n.farType&&(r=parseInt(n.farType)),this._map.setupFar(n.far,r,this._container_far,parseInt(n.farX),parseInt(n.farY));break}}if(i.tiled)for(var s=0;s<i.tiled.length;s++){var a=i.tiled[s];if(""!=a.tiled){var o=0;""!=a.tiledType&&(o=parseInt(a.tiledType));var h=new Array;if(null!=a.tiledLayer)for(var l=0,p=a.tiledLayer.length;p>l;l++){var _=a.tiledLayer[l];h.push(_)}this._map.setupTiled(a.tiled,o,h,this._container_bottom);break}}for(var s=0;s<i.monster.length;s++){var c=i.monster[s],u=new t.MonsterFlushData;u.format(c),this._monsterConf.push(u)}for(var d=i.npc.length,s=0;d>s;s++){var m=i.npc[s],f=t.D5ConfigCenter.my.getNpcConf(m.uid),g=t.GOData.getInstance();g.setDirection(t.Direction.Down),g.setRespath(f?f.skin:e.RES_SERVER+e.ASSET_PATH+"/mapRes/"+m.res),g.setNickname(m.name),g.setPos(m.posx,m.posy),g.setUid(m.uid),g.setSay(m.say),g.setScript(m.script),g.setWork(t.GOData.WORK_NPC),null!=m.job&&g.setJob(parseInt(m.job.type),m.job.value,m.job.num),this.addObject(g)}for(var v=i.roadpoint.length,s=0;v>s;s++){var w=i.roadpoint[s],g=t.GOData.getInstance();g.setDirection(t.Direction.Down),g.setRespath(e.RES_SERVER+e.ASSET_PATH+"/mapRes/"+w.res),g.setLink(w.toMap,w.toX,w.toY),g.setPos(w.posx,w.posy),g.setWork(t.GOData.WORK_DOOR),this.addObject(g)}if(i.event)for(var s=0;s<i.event.length;s++){var y=i.event[s],g=t.GOData.getInstance();g.setChecktime(y.checktime),g.setChecksize(y.checksize),g.setCheckdel(y.checkdel),g.setScript(y.script),g.setPos(y.posx,y.posy),g.setWork(t.GOData.WORK_EVENT),this.addObject(g)}},p.playMusic=function(t){t&&(this._sound=t,this._soundChannel=this._sound.play(0,0))},p.stopMusic=function(){this._sound&&this._soundChannel&&(this._soundChannel.stop(),this._soundChannel=null)},p.flushMoster=function(){},p.init=function(){this.flushMoster(),this.initUI(),console.log("[D5Game] Engine is ready.enjoy~"),this.buildPlayer(),this._player?(this._player.setPos(this._startX,this._startY),this._player.controller&&this._player.controller.setupListener(),this._camera.update()):this._camera.lookAt(this._startX,this._startY),e.me.g&&(e.me.map.getRoadPass(this._startX,this._startY)||(e.me.g.addObject(this._player),this._player.inG=!0,this._player.speedY=3)),null!=this._readyBack&&(this._readyBack(),this._readyBack=null),this.play()},s(p,"touchReciver",function(){return this._touch_layer}),p.buildPlayer=function(){},p.play=function(){this.addEventListener(egret.Event.ENTER_FRAME,this._runAction,this)},p.stop=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this._runAction,this)},p.run=function(i){void 0===i&&(i=null),this._timer=egret.getTimer(),this._map.render(!1),this._map.runPos(this._dataList),null!=this._g&&this._g.run();for(var e=this._screenList.length-1;e>=0;e--)(this._screenList[e].deleting||!this._screenList[e].inScreen)&&this._screenList.splice(e,1);var s=this._timer-this._lastZorder>this._camera.zorderSpeed;if(s){this._screenList.sort(function(t,i){return t.zOrder>i.zOrder?1:-1});for(var n,r,a=this._screenList.length;a--;)r=this._screenList[a].displayer,a<this._container.numChildren&&(n=this._container.getChildAt(a),n!=r&&this._container.setChildIndex(r,a));this._lastZorder=this._timer,this._camera.reCut()}for(var o;;){if(o=this._screenList[this._nowRend],null==o){this._nowRend=0;break}if(o.renderMe(),this._nowRend++,egret.getTimer()-this._timer>t.D5Camera.RenderMaxTime)break}this._camera.update()},p.buildMap=function(i){this._map=new t.D5Map(i)},p.reset=function(){this.stop(),this.map.clear();var t;for(t=this._screenList.length-1;t>=0;t--)this.remove4ScreenByIndex(t);for(t=this._dataList.length-1;t>=0;t--)this.removeObject(t);this._player=null,this._camera.setFocus(null),this.stopMusic()},p.onResize=function(){this._screenW=this.stage.stageWidth,this._screenH=this.stage.stageHeight,this._touch_layer.graphics.clear(),this._touch_layer.graphics.beginFill(0,0),this._touch_layer.graphics.drawRect(0,0,this._screenW,this._screenH),this._touch_layer.graphics.endFill(),this._touch_layer.width=this._screenW,this._touch_layer.height=this._screenH},p.install=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.install,this),this.stage.addEventListener(egret.Event.RESIZE,this.onResize,this),this.onResize(null),this.enterMap()},p.enterMap=function(t){void 0===t&&(t=-1),RES.getResByUrl(e.RES_SERVER+e.ASSET_PATH+"/tiles/"+(-1==t?this._map.id:t)+"/mapconf.json",this.setup,this)},p.error=function(){throw new Error("[D5Game] Please get instance by (get me) function.")},e.MI=50,e.RES_SERVER="",e.ASSET_PATH="resource/assets",e}(egret.DisplayObjectContainer);t.D5Game=i,egret.registerClass(i,"d5power.D5Game")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(){this.JUMP_POWER=5,this.JUMP_MAX=2,this._objects=[]}var e=__define,s=i;return p=s.prototype,p.initGravity=function(t,i,e){void 0===i&&(i=0),void 0===e&&(e=5),this._gy=t,this._gx=i},p.addObject=function(t){-1==this._objects.indexOf(t)&&this._objects.push(t)},p.removeObject=function(t){var i=this._objects.indexOf(t);-1!=i&&this._objects.splice(i,1)},p.clearObject=function(){this._objects=[]},e(p,"counts",function(){return this._objects.length}),p.run=function(){var i,e,s,n;for(i=this._objects.length;i>0;i--)if(e=this._objects[i-1],e.inG){e.inScreen||this._objects.splice(i,1),e.speedX+=this._gx,e.speedY+=this._gy,s=e.posX+e.speedX,n=e.posY+e.speedY;var r=t.D5Game.me.map.Postion2Tile(s,n);e.speedY>0&&t.D5Game.me.map.getRoadPass(r.x,r.y)&&(e.inG=!1,e.speedX=0,e.speedY=0)}},i}();t.D5Gravity=i,egret.registerClass(i,"d5power.D5Gravity")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(t){this._roadW=60,this._roadH=30,this._posX=0,this._speed=6.6,this._nowStartX=0,this._count=0,this._mapid=t,this._tempPoint=new egret.Point,this._tileList=[]}var e=__define,s=i;return p=s.prototype,i.getTile=function(){return i._pool.length>0?i._pool.pop():new egret.Bitmap},i.back2Pool=function(t){t.texture=null,t.parent&&t.parent.removeChild(t),-1==i._pool.indexOf(t)&&i._pool.push(t)},p.clear=function(){},p.runPos=function(i){for(var e=i.length-1;e>=0;e--)i[e].deleting?t.D5Game.me.removeObject(e):i[e].run()},p.render=function(t){void 0===t&&(t=!1),this._posX+=this._speed;var e=parseInt(this._posX/this._roadW);this.makeData(e);for(var s,n,r=0;3>r;r++)this._far[r].x-=.12*this._speed,this._far[r].x<-this._far[r].width&&(s=this._far[r]),this._middle[r].x-=.6*this._speed,this._middle[r].x<-this._middle[r].width&&(n=this._middle[r]);for(n&&(n.x=this._rightMiddle.x+this._rightMiddle.width,this._rightMiddle=n,this._layer_middle.cacheAsBitmap=!0),s&&(s.x=this._rightFar.x+this._rightFar.width,this._rightFar=s,this._layer_far.cacheAsBitmap=!0),r=this._tileList.length-1;r>=0;r--)s=this._tileList[r],s.x-=this._speed,s.x<=-s.width&&(i.back2Pool(s),this._tileList.splice(r,1))},p.reset=function(){},p.setContainer=function(t){t.removeChildren(),null==this._layer_far?(this._layer_far=new egret.DisplayObjectContainer,this._layer_middle=new egret.DisplayObjectContainer,this._layer_neer=new egret.DisplayObjectContainer):(this._layer_far.removeChildren(),this._layer_middle.removeChildren(),this._layer_neer.removeChildren()),t.addChild(this._layer_far),t.addChild(this._layer_middle),t.addChild(this._layer_neer)},p.setTileFormat=function(){},p.setup=function(i,e,s,n,r,a,o){this._mapid=i,this._mapHeight=s,this._mapWidth=e,this._tileW=n,this._tileH=r,this._onReady=a,this._onReadyThis=o,RES.getResByUrl(t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/map.png",this.onResLoaded,this)},p.setupTiled=function(){},p.setupFar=function(){},e(p,"id",function(){return this._mapid}),e(p,"width",function(){return this._mapWidth}),e(p,"height",function(){return this._mapHeight}),e(p,"tileWidth",function(){return this._tileW}),e(p,"tileHeight",function(){return this._tileH}),e(p,"roadWidth",function(){return this._roadW}),e(p,"roadHeight",function(){return this._roadH}),p.find=function(){return null},p.getPointAround=function(){return null},p.getRoadPass=function(t,i){return null==this._roadArr?!0:null==this._roadArr[i]||0!=this._roadArr[i][t]?!1:!0},p.isInAlphaArea=function(){return!1},p.getScreenPostion=function(i,e){return this._tempPoint.x=i-t.D5Game.me.camera.zeroX,this._tempPoint.y=e-t.D5Game.me.camera.zeroY,this._tempPoint},p.getWorldPostion=function(i,e){return this._tempPoint.x=t.D5Game.me.camera.zeroX+i,this._tempPoint.y=t.D5Game.me.camera.zeroY+e,this._tempPoint},p.tile2WorldPostion=function(t,i){return this._tempPoint.x=t*this._roadW+.5*this._roadW,this._tempPoint.y=i*this._roadH+.5*this._roadH,this._tempPoint},p.Postion2Tile=function(t,i){return this._tempPoint.x=Math.floor(t/this._roadW),this._tempPoint.y=Math.floor(i/this._roadH),this._tempPoint},p.onResLoaded=function(i){this._sheet=new egret.SpriteSheet(i),RES.getResByUrl(t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/resconf.json",this.onDataComplate,this)},p.onDataComplate=function(i){if(i.uv)for(var e=0,s=i.uv.length;s>e;e++)this._sheet.createTexture(i.uv[e].name,i.uv[e].x,i.uv[e].y,i.uv[e].width,i.uv[e].height,0,0);this._far=[],this._middle=[],this._far[0]=new egret.Bitmap,this._far[1]=new egret.Bitmap,this._far[2]=new egret.Bitmap,this._far[0].texture=this._sheet.getTexture("far"),this._far[1].texture=this._sheet.getTexture("far"),this._far[2].texture=this._sheet.getTexture("far"),this._rightFar=this._far[2],this._far[0].height=this._far[1].height=this._far[2].height=t.D5Game.me.screenWidth/this._rightFar.width*this._rightFar.height,this._far[0].width=this._far[1].width=this._far[2].width=t.D5Game.me.screenWidth,this._far[1].x=this._rightFar.width,this._far[2].x=2*this._rightFar.width,this._layer_far.addChild(this._far[0]),this._layer_far.addChild(this._far[1]),this._layer_far.addChild(this._far[2]),this._middle[0]=new egret.Bitmap,this._middle[1]=new egret.Bitmap,this._middle[2]=new egret.Bitmap,this._middle[0].texture=this._sheet.getTexture("middle"),this._middle[1].texture=this._sheet.getTexture("middle"),this._middle[2].texture=this._sheet.getTexture("middle"),this._rightMiddle=this._middle[2],this._middle[0].height=this._middle[1].height=this._middle[2].height=t.D5Game.me.screenWidth/this._rightMiddle.width*this._rightMiddle.height,this._middle[0].width=this._middle[1].width=this._middle[2].width=t.D5Game.me.screenWidth,this._middle[1].x=this._rightMiddle.width,this._middle[2].x=2*this._rightMiddle.width,this._middle[0].y=this._middle[1].y=this._middle[2].y=.3*this._rightFar.height*1.5,this._layer_middle.addChild(this._middle[0]),this._layer_middle.addChild(this._middle[1]),this._layer_middle.addChild(this._middle[2]),this.resetRoad(),null!=this._onReady&&this._onReady.apply(this._onReadyThis)},p.resetRoad=function(){this._roadArr=[];for(var i,e=Math.floor(t.D5Game.me.screenHeight/this._roadH),s=Math.floor(t.D5Game.me.screenWidth/this._roadW)+2,n=Math.floor(.25*t.D5Game.me.screenHeight*3/this._roadH),r=0;e>r;r++){for(var a=new Array,o=0;s>o;o++)i=r!=n?0:1,a.push(i),1==i&&this.drawTile(r,o,a);this._roadArr.push(a)}},p.drawTile=function(t,e,s){var n;n=i.getTile(),n.texture=this._sheet.getTexture(e>0&&null!=s&&0==s[e-1]?"tile_left":null==s||e<s.length-1&&0==s[e+1]?"tile_right":"tile_middle"),n.width=this._roadW,n.height=this._roadW,n.x=null==this._lastAdd?e*this._roadW:this._lastAdd.x+this._roadW,n.y=t*this._roadH,this._lastAdd=n,this._layer_neer.addChild(n),this._tileList.push(n)},p.makeData=function(t){if(this._nowStartX!=t){this._nowStartX=t,0==this._count&&(this._lastAdd=null,this._rline=-1==this._rline?8+parseInt(3*Math.random()):-1,this._count=-1==this._rline?1+parseInt(4*Math.random()):2+parseInt(8*Math.random()));for(var i,e=0,s=this._roadArr.length;s>e;e++){var n=this._roadArr[e];n.shift(),i=e!=this._rline?0:1,n.push(i),1==i&&this.drawTile(e,n.length-1,1==this._count?null:n)}this._count--}},p.setDeviceorientation=function(){},i._pool=[],i}();t.D5HMap=i,egret.registerClass(i,"d5power.D5HMap",["d5power.IMap"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(t){this._tileFormat=".jpg",this._roadW=60,this._roadH=30,this._nowStartX=-1,this._nowStartY=-1,this._nowName="",this._nowTiledStartX=-1,this._nowTiledStartY=-1,this._tiledRows=1,this._tiledCols=1,this._isReady=!1,this._tiledLoadNum=0,this._deviceorientation=!1,this._mapid=t}var e=__define,s=i;return p=s.prototype,i.rebuildPool=function(t){if(i._tilePool.length>t)for(;i._tilePool.length>t;)i._tilePool.pop();else for(;i._tilePool.length<t;)i._tilePool.push(new egret.Bitmap)},i.back2pool=function(t){-1==i._tilePool.indexOf(t)&&i._tilePool.push(t)},i.getTile=function(){var t;return t=i._tilePool.length?i._tilePool.pop():new egret.Bitmap,t.texture=null,t},e(p,"id",function(){return this._mapid}),p.setContainer=function(t){t!=this._dbuffer&&(null!=this._dbuffer&&(this._dbuffer.removeChildren(),this._dbuffer.parent&&this._dbuffer.parent.removeChild(this._dbuffer)),this._dbuffer=t)},p.setTileFormat=function(t){"."!=t.substr(0,1)&&(t="."+t),this._tileFormat=t},p.setup=function(i,e,s,n,r,a,o){this._mapid=i,this._mapHeight=s,this._mapWidth=e,this._tileW=n,this._tileH=r,this._onReady=a,this._onReadyThis=o,this._nowStartX=-1,this._nowStartY=-1;var h=function(i){this._smallMap=i,this._smallMap=new egret.SpriteSheet(i),this.createSmallData(i.textureWidth,i.textureHeight),RES.getResByUrl(t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/roadmap.bin",this.setupRoad,this,RES.ResourceItem.TYPE_BIN)};RES.getResByUrl(t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/s.jpg",h,this)},p.createSmallData=function(t,i){var e,s,n=t/(this._mapWidth/this._tileW),r=i/(this._mapHeight/this._tileH);for(s=0;s<this._mapWidth/this._tileW;s++)for(e=0;e<this._mapHeight/this._tileH;e++)this._smallMap.createTexture("small"+s+"_"+e,e*n,s*r,n,r,0,0)},e(p,"width",function(){return this._mapWidth}),e(p,"height",function(){return this._mapHeight}),e(p,"tileWidth",function(){return this._tileW}),e(p,"tileHeight",function(){return this._tileH}),e(p,"roadWidth",function(){return this._roadW}),e(p,"roadHeight",function(){return this._roadH}),p.runPos=function(i){for(var e=i.length-1;e>=0;e--)i[e].deleting?t.D5Game.me.removeObject(e):i[e].run()},p.render=function(i){void 0===i&&(i=!1),this.mod_buffer&&(this.mod_buffer=!1,this._dbuffer.cacheAsBitmap=!0);var e=parseInt(t.D5Game.me.camera.zeroX/this._tileW),s=parseInt(t.D5Game.me.camera.zeroY/this._tileH);if(this.makeData(e,s,i),this.makeTiledData(),this.makeFarData(),this._nowStartX==e&&this._nowStartY==s&&null!=this._posFlush){var n=t.D5Game.me.camera.zeroX%this._tileW,r=t.D5Game.me.camera.zeroY%this._tileH;this._dbuffer.x=-n,this._dbuffer.y=-r}},p.resize=function(){this._areaX=Math.ceil(t.D5Game.me.screenWidth/this._tileW)+1,this._areaY=Math.ceil(t.D5Game.me.screenHeight/this._tileH)+1,console.log("[D5Game] max tiles number ",this._areaX,this._areaY),i.rebuildPool(this._areaX*this._areaY+this._areaX+this._areaY)},p.resetRoad=function(){this._roadArr=[],this._alphaArr=[];for(var t=Math.floor(this._mapHeight/this._roadH),i=Math.floor(this._mapWidth/this._roadW),e=0;t>e;e++){for(var s=new Array,n=new Array,r=0;i>r;r++)s.push(0),n.push(0);this._roadArr.push(s),this._alphaArr.push(n)}},p.setRoad=function(t){this._roadArr=t},p.isInAlphaArea=function(t,e){var s=this.Postion2Tile(t,e);return this._alphaArr[s.y]&&this._alphaArr[s.y][s.x]==i.BIN_ALPHA_VALUE},p.getPointAround=function(i,e,s){for(var n=0,r=10,a=2*Math.PI/r,o=new egret.Point,h=t.GMath.getPointAngle(i.x-e.x,i.y-e.y)+(Math.random()>.5?1:-1)*Math.PI/8;r>n;){var l=a*n+h;if(o.x=i.x-s*Math.cos(l),o.y=i.y-s*Math.sin(l),this.PointCanMove(o,e))return o;n++}return null},p.PointCanMove=function(t,i){if(null==this._astar)return!0;var e=this._astar.find(i.x,i.y,t.x,t.y);return null!=e},p.getRoadPass=function(t,i){return null==this._roadArr[i]||0!=this._roadArr[i][t]?!1:!0},p.find=function(t,i,e,s){return null==this._astar?null:this._astar.find(t,i,e,s)},p.getWorldPostion=function(i,e){return this._tempPoint.x=t.D5Game.me.camera.zeroX+i,this._tempPoint.y=t.D5Game.me.camera.zeroY+e,this._tempPoint},p.getScreenPostion=function(i,e){return this._tempPoint.x=i-t.D5Game.me.camera.zeroX,this._tempPoint.y=e-t.D5Game.me.camera.zeroY,this._tempPoint},p.tile2WorldPostion=function(t,i){return this._tempPoint.x=t*this._roadW+.5*this._roadW,this._tempPoint.y=i*this._roadH+.5*this._roadH,this._tempPoint},p.Postion2Tile=function(t,i){return null==this._tempPoint&&(this._tempPoint=new egret.Point),this._tempPoint.x=Math.floor(t/this._roadW),this._tempPoint.y=Math.floor(i/this._roadH),this._tempPoint},p.reset=function(){this._tempPoint=new egret.Point,this._mapResource={tiles:new Object},this._dbuffer.removeChildren()},p.setupRoad=function(e){if(null==e||void 0==e)this.resetRoad();else{var s=new egret.ByteArray;s._setArrayBuffer(e);var n,r=s.readUTFBytes(5),a=0,o=0;if("D5Map"==r){o=s.readShort(),a=s.readShort();for(var h=[],l=0;o>l;l++){for(var p=[],_=0;a>_;_++)p.push(s.readByte());h.push(p)}if(this.resetRoad(),a>1){var c=Math.floor(this._mapHeight/this._roadH),u=Math.floor(this._mapWidth/this._roadW),d=u==a&&c==o?1:o/c;for(l=0;c>l;l++)for(_=0;u>_;_++)try{o=Math.floor(l*d),a=Math.floor(_*d),n=h[o][a],this._roadArr[l][_]=n==i.BIN_NO_VALUE?1:0,this._alphaArr[l][_]=n}catch(m){trace("［D5Map］路点超出范围Y:X("+l+":"+_+")",o,a),this._roadArr[l][_]=i.BIN_NO_VALUE,this._alphaArr[l][_]=i.BIN_NO_VALUE}}}else console.log("[D5Map]非法的地图配置文件")}this.reset(),this.resize(),this._astar=new t.SilzAstar(this._roadArr),null!=this._onReady&&this._onReady.apply(this._onReadyThis)},p.makeData=function(t,i){if(this._nowStartX!=t||this._nowStartY!=i){this._nowStartX=t,this._nowStartY=i,this._posFlush=[];for(var e=0,s=this._dbuffer.numChildren;s>e;e++)this._dbuffer.getChildAt(e).texture=null;for(var n,r=Math.min(i+this._areaY,Math.floor(this._mapHeight/this._tileH)),a=Math.min(t+this._areaX,Math.floor(this._mapWidth/this._tileW)),o=i;r>o;o++)for(var h=t;a>h;h++)n=o+"_"+h,0>h||0>o||(null==this._mapResource.tiles[n]?(this._posFlush.push(o+"_"+h+"_"+this._nowStartX+"_"+this._nowStartY+"_"+this._mapid),this.fillSmallMap(o,h,h-this._nowStartX,o-this._nowStartY)):this.fillTile(h-this._nowStartX,o-this._nowStartY,this._mapResource.tiles[n]));this.loadTiles()}},p.clear=function(){this._mapResource={tiles:new Object};for(var t;this._dbuffer.numChildren;)t=this._dbuffer.removeChildAt(0),t.texture=null,i.back2pool(t);if(this._tiledBuff)for(;this._tiledBuff.numChildren;)t=this._tiledBuff.removeChildAt(0),t.texture=null,i.back2pool(t);this.tmx=null,this._isReady=!1,this._tiledLayerData=null,this._tiledResource=null,this._nowName=""},p.loadTiles=function(i){if(void 0===i&&(i=null),null!=i){var e=this._nowName.split("_");if(parseInt(e[4])!=this._mapid)return void console.log("[D5Map] 读取了已切换了的地图资源");var s=e[0]+"_"+e[1];null==this._mapResource.tiles[s]&&(this._mapResource.tiles[s]=i);var n=parseInt(e[1])-this._nowStartX,r=parseInt(e[0])-this._nowStartY;parseInt(e[2])==this._nowStartX&&parseInt(e[3])==this._nowStartY&&this.fillTile(n,r,i),this._nowName=""}if(0==this._posFlush.length)this._dbuffer.cacheAsBitmap=!1,this.mod_buffer=!0;else if(""==this._nowName){this._nowName=this._posFlush.pop();var e=this._nowName.split("_"),a=t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/"+e[0]+"_"+e[1]+this._tileFormat;RES.getResByUrl(a,this.loadTiles,this)}},p.fillTile=function(t,e,s){var n=this._dbuffer.getChildByName(t+"_"+e);null==n&&(n=i.getTile(),n.x=t*this._tileW,n.y=e*this._tileH,n.name=t+"_"+e,this._dbuffer.addChild(n)),n.texture=s,this._dbuffer.cacheAsBitmap=!0},p.fillSmallMap=function(t,e,s,n){var r=this._smallMap.getTexture("small"+t+"_"+e),a=this._dbuffer.getChildByName(s+"_"+n);null==a&&(a=i.getTile(),a.x=s*this._tileW,a.y=n*this._tileH,a.fillMode=egret.BitmapFillMode.SCALE,a.name=s+"_"+n,this._dbuffer.addChild(a)),a.texture=r,a.width=this._tileW,a.height=this._tileH,this._dbuffer.cacheAsBitmap=!0},p.setupTiled=function(i,e,s,n){this._tiledResource={},this._tiledType=e,this._tiledLayerData=s,this._tiledBuff=n,this._tiledName=i,RES.getResByUrl(t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/"+i,this.onTiledLoaded,this)},p.onTiledLoaded=function(i){if(i){this.tmx=new t.TiledMap,this.tmx.format(i),this._nowTiledSet=this.tmx.imgLib[this._tiledLoadNum];var e=t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/"+this._nowTiledSet.imageSource;RES.getResByUrl(e,this.loadTiled,this)}},p.loadTiled=function(i){if(void 0===i&&(i=null),this._tiledLoadNum++,t.TiledResourceData.setupResLib(this._tiledName,i,this._nowTiledSet),this._tiledLoadNum<this.tmx.imgLib.length){this._nowTiledSet=this.tmx.imgLib[this._tiledLoadNum];var e=t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/"+this._nowTiledSet.imageSource;return void RES.getResByUrl(e,this.loadTiled,this)}for(var s,n,r,a=0;a<this._tiledLayerData.length;++a){var o=this._tiledLayerData[a];if(null==o.data)break;s=t.Base64.decodeToArray(o.data,o.width,!1),n=s.length;for(var h=0;n>h;++h){r=s[h].length;for(var l=0;r>l;++l)if(0!=s[h][l]){var p=new egret.Bitmap,_=new egret.Texture;_=t.TiledResourceData.getResource(this._tiledName,s[h][l]),p.texture=_,this._tiledResource[a+"_"+h+"_"+l]=_}}}this._isReady=!0,this._tiledLoadNum=0},p.makeTiledData=function(){if(this.tmx&&this._isReady){this._tiledareaX=Math.floor(t.D5Game.me.screenWidth/this.tmx.tileWidth)+1,this._tiledareaY=Math.floor(t.D5Game.me.screenHeight/this.tmx.tileHeight)+1;var i=Math.floor(t.D5Game.me.camera.zeroX/this.tmx.tileWidth),e=Math.floor(t.D5Game.me.camera.zeroY/this.tmx.tileHeight),s=t.D5Game.me.camera.zeroX%this.tmx.tileWidth,n=t.D5Game.me.camera.zeroY%this.tmx.tileHeight;if(this._tiledBuff.x=-s,this._tiledBuff.y=-n,this._nowTiledStartX!=i||this._nowTiledStartY!=e){this._nowTiledStartX=i,this._nowTiledStartY=e,this._tiledRows=this.tmx.width,this._tiledCols=this.tmx.height;
var r,a;for(r=0,a=this._tiledBuff.numChildren;a>r;r++)this._tiledBuff.getChildAt(r).texture=null;var o,h=Math.ceil(t.D5Game.me.stage.stageWidth/this.tmx.tileWidth)+i+1,l=Math.ceil(t.D5Game.me.stage.stageHeight/this.tmx.tileHeight)+e+1;for(r=0,a=this.tmx.layers_ordered.length;a>r;r++)for(var p=e;l>p;p++)for(var _=i;h>_;_++){o=this.fillTiledMap(r,p,_);var c=new egret.Bitmap,u=this._tiledResource[o],d=this._tiledBuff.getChildByName(o);c?d?(d.texture=u,d.x=(_-i)*this.tmx.tileWidth,d.y=(p-e)*this.tmx.tileHeight):(this._tiledBuff.addChild(c),c.name=o,c.texture=u,c.x=(_-i)*this.tmx.tileWidth,c.y=(p-e)*this.tmx.tileHeight):d&&(d.texture=null)}this._tiledBuff.cacheAsBitmap=!0}}},p.fillTiledMap=function(t,i,e){var s="";switch(s+=t,this._tiledType){case 2:s+="_"+i%this._tiledCols+"_"+e;break;case 1:s+="_"+i+"_"+e%this._tiledRows;break;case 3:s+="_"+i%this._tiledCols+"_"+e%this._tiledRows;break;case 0:default:s+="_"+i+"_"+e}return s},p.setupFar=function(i,e,s,n,r){this._farName=i,this._farType=e,this._farBuff=s,this._far_x=n,this._far_y=r,RES.getResByUrl(t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/tiles/"+this._mapid+"/"+i,this.onFarLoaded,this)},p.onFarLoaded=function(t){if(t){this._farDisplayer||(this._farDisplayer=new egret.Bitmap,this._farBuff.addChild(this._farDisplayer)),this._farDisplayer.texture=t;var i,e;switch(this._farType){case 1:this._farDisplayer.fillMode=egret.BitmapFillMode.REPEAT,i=this._mapWidth,e=t.textureHeight;break;case 2:this._farDisplayer.fillMode=egret.BitmapFillMode.REPEAT,i=t.textureWidth,e=this._mapHeight;break;case 3:this._farDisplayer.fillMode=egret.BitmapFillMode.REPEAT,i=this._mapWidth,e=this._mapHeight;break;case 0:default:this._farDisplayer.fillMode=egret.BitmapFillMode.SCALE,i=t.textureWidth,e=t.textureHeight}this._farDisplayer.width=i,this._farDisplayer.height=e,this._farDisplayer.x=this._far_x,this._farDisplayer.y=this._far_y,this._farBuff.cacheAsBitmap=!0}},p.makeFarData=function(){this._farBuff&&(this._farBuff.x=-t.D5Game.me.camera.zeroX,this._farBuff.y=-t.D5Game.me.camera.zeroY)},p.setDeviceorientation=function(t){this._deviceorientation=t,t?window.addEventListener("deviceorientation",this.ondeviceorientation):window.removeEventListener("deviceorientation",this.ondeviceorientation)},e(p,"Deviceorientation",function(){return this._deviceorientation}),p.ondeviceorientation=function(){},i.BIN_ALPHA_VALUE=2,i.BIN_CAN_VALUE=1,i.BIN_NO_VALUE=0,i._tilePool=new Array,i}();t.D5Map=i,egret.registerClass(i,"d5power.D5Map",["d5power.IMap"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(){i.call(this),this.ID=0,this._playFrame=0,this._alphaCheckTime=0,this._loadID=0,this._flag=!1,this._monitor=new egret.Bitmap}__extends(e,i);var s=__define,n=e;return p=n.prototype,e.setupMissionIcon=function(t){var i=t._bitmapWidth>>2,s=t._bitmapHeight;e._missionIcon=new egret.SpriteSheet(t);for(var n=0;4>n;n++)e._missionIcon.createTexture("mission"+n,n*i,0,i,s,0,0)},s(e,"MissionOver",function(){return null==e._missionIcon?null:e._missionIcon.getTexture("mission0")}),s(e,"MissionOver0",function(){return null==e._missionIcon?null:e._missionIcon.getTexture("mission1")}),s(e,"MissionStart",function(){return null==e._missionIcon?null:e._missionIcon.getTexture("mission2")}),s(e,"MissionStart0",function(){return null==e._missionIcon?null:e._missionIcon.getTexture("mission3")}),e.getInstance=function(){var t;return t=e._pool.length?e._pool.pop():new e},e.back2pool=function(t){e._pool.length<e.MAX_POOL_NUM&&-1==e._pool.indexOf(t)&&e._pool.push(t)},s(p,"loadID",function(){return this._loadID}),s(p,"inScreen",function(){return this._inScreen}),s(p,"deleteing",function(){return this._deleting}),s(p,"camp",function(){return this._camp}),p.hitTestArea=function(t,i){return null==this._spriteSheet?!1:t>=this.x+this._spriteSheet.gX&&i>=this.y+this._spriteSheet.gY&&t<this.x+this._spriteSheet.gX+this._spriteSheet.frameWidth&&i<=this.y+this._spriteSheet.gY+this.spriteSheet.frameHeight},p.renderMe=function(){this.renderAction(),null!=this._drawAction?this._drawAction():0},s(p,"spriteSheet",function(){return this._spriteSheet}),p.setupData=function(t){this._data=t},p.dispose=function(){this._spriteSheet&&(this._spriteSheet.unlink(),this._spriteSheet=null),this._data=null,this._monitor.texture=null,this._drawAction=null,this._loadID=0,this._playFrame=0,this._missionIcon&&(this._missionIcon.texture=null,this.contains(this._missionIcon)&&this.removeChild(this._missionIcon)),this._nameShower&&this.contains(this._nameShower)&&(this._nameShower.text="",this.removeChild(this._nameShower)),this.contains(this._monitor)&&this.removeChild(this._monitor),this._shadow&&this._shadow.graphics.clear(),this._hpBar&&this.contains(this._hpBar)&&this.removeChild(this._hpBar),this._spBar&&this.contains(this._spBar)&&this.removeChild(this._spBar),this._hpBar=null,this._spBar=null,e.back2pool(this)},p.showMissionStatus=function(i){if(null==t.D5Game.me.characterData||null==t.D5Game.me.missionDispatcher)return void console.log("[GameObject] 暂未设置角色信息存储数据。请通过D5Game.me.characterData进行设置。");if(-1==i)return void(this._missionIcon&&this.contains(this._missionIcon)&&this.removeChild(this._missionIcon));this._missionIcon||(this._missionIcon=new egret.Bitmap);var s=t.D5Game.me.characterData.getMissionByIndex(i).missionData;if(s){this._missionIcon.texture=s.type==t.MissionData.TYPE_GET&&s.check(t.D5Game.me.missionDispatcher)?e.MissionOver:s.type==t.MissionData.TYPE_GET?e.MissionOver0:s.check(t.D5Game.me.missionDispatcher)?e.MissionStart:e.MissionStart0,this.showMissionIcon()}},p.renderAction=function(){t.D5Game.me.timer-this._alphaCheckTime>500&&(this._alphaCheckTime=t.D5Game.me.timer,this._monitor.alpha=t.D5Game.me.map.isInAlphaArea(this._data.posX,this._data.posY)?.5:1)},p.setupSkin=function(i){this._loadID++,t.D5SpriteSheet.getInstance(i,this)},p.onSpriteSheepReady=function(t){this._spriteSheet&&this._spriteSheet.unlink(),this._drawAction=this.draw,this._spriteSheet=t,0!=this._spriteSheet.shadowX&&0!=this._spriteSheet.shadowY&&(null==this._shadow?this._shadow=new egret.Shape:this._shadow.graphics.clear(),this._shadow.graphics.lineStyle(),this._shadow.graphics.beginFill(0,.2),this._shadow.graphics.drawEllipse(0,0,this._spriteSheet.shadowX,this._spriteSheet.shadowY),this._shadow.graphics.endFill()),this.contains(this._monitor)||this.addChild(this._monitor),this.showMissionIcon(),this.showPos()},p.showMissionIcon=function(){null!=this._missionIcon&&this.contains(this._monitor)&&(this._missionIcon.y=-this._spriteSheet.frameHeight-this._missionIcon.height,this._missionIcon.x=-(this._missionIcon.width>>1),this.contains(this._missionIcon)||this.addChild(this._missionIcon)),null!=this._data&&null!=this._data.nickname&&this.contains(this._monitor)&&(null==this._nameShower&&(this._nameShower=new egret.TextField),this._nameShower.size=12,this._nameShower.textColor=t.D5Game.me.characterData.camp==this._data.camp?10092288:16711680,this._nameShower.text=this._data.nickname,this._nameShower.x=-(this._nameShower.width>>1),this.addChild(this._nameShower))},p.setHpBar=function(t){this._hpBar=t,this.addChild(this._hpBar)},p.updateBar=function(){this._hpBar&&this._hpBar.update(),this._spBar&&this._spBar.update()},p.setSpBar=function(t){this._spBar=t,this.addChild(this._spBar)},p.showPos=function(){},p.draw=function(){if(!(t.D5Game.me.timer-this._lastRender<this._spriteSheet.renderTime)){this._lastRender=t.D5Game.me.timer;var i=this._data.direction;this._data.direction<=4?(1==this._spriteSheet.totalDirection?(i=0,this._monitor.texture=this._spriteSheet.getTexture(i,this._playFrame)):4==this._spriteSheet.totalDirection?((1==i||2==i||3==i)&&(i=1),this._monitor.texture=this._spriteSheet.getTexture(i,this._playFrame)):this._monitor.texture=this._spriteSheet.getTexture(i,this._playFrame),this._monitor.scaleX=1,this._spriteSheet.uvList?(this._monitor.x=this._spriteSheet.uvList[i*this._spriteSheet.totalFrame+this._playFrame].offX,this._monitor.y=this._spriteSheet.uvList[i*this._spriteSheet.totalFrame+this._playFrame].offY):(this._monitor.x=this._spriteSheet.gX,this._monitor.y=this._spriteSheet.gY)):(1==this._spriteSheet.totalDirection?(i=0,this._monitor.texture=this._spriteSheet.getTexture(i,this._playFrame)):4==this._spriteSheet.totalDirection?(i=1,this._monitor.texture=this._spriteSheet.getTexture(i,this._playFrame)):(i=8-this._data.direction,this._monitor.texture=this._spriteSheet.getTexture(i,this._playFrame)),this._monitor.scaleX=-1,this._spriteSheet.uvList?(this._monitor.x=-this._spriteSheet.uvList[i*this._spriteSheet.totalFrame+this._playFrame].offX,this._monitor.y=this._spriteSheet.uvList[i*this._spriteSheet.totalFrame+this._playFrame].offY):(this._monitor.x=-this._spriteSheet.gX,this._monitor.y=this._spriteSheet.gY)),this._playFrame++,this._playFrame>=this._spriteSheet.totalFrame&&(this._playFrame=0),this._data.action==t.Actions.Attack&&(0==this._playFrame&&this._flag&&(this._data.setAction(t.Actions.Wait),this._flag=!1),this._playFrame+1>=this._spriteSheet.totalFrame&&!this._flag&&(this.atkfun(),this._flag=!0))}},e.MAX_POOL_NUM=100,e._pool=[],e}(egret.DisplayObjectContainer);t.GameObject=i,egret.registerClass(i,"d5power.GameObject",["d5power.IGO","d5power.ISpriteSheetWaiter"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(){i.call(this)}__extends(e,i);var s=(__define,e);return p=s.prototype,e.getDoor=function(){var t;return t=e._pool_door.length?e._pool_door.pop():new e,t._lock=!1,t._lastCheck=0,t},e.backDoor=function(t){e._pool_door.length<e.MAX_POOL_NUM&&-1==e._pool_door.indexOf(t)&&e._pool_door.push(t)},p.renderAction=function(){!this._lock&&t.D5Game.me.timer-this._lastCheck>500&&egret.Point.distance(this._data.$pos,t.D5Game.me.player.$pos)<50&&(this._lastCheck=t.D5Game.me.timer,this._lock=!0,console.log("change Map"),t.D5Game.me.changeMap(this._data.linkMap,this._data.linkPosx,this._data.linkPosy))},p.dispose=function(){this._spriteSheet&&(this._spriteSheet.unlink(),this._spriteSheet=null),this._data=null,this._monitor.texture=null,this._drawAction=null,this.contains(this._monitor)&&this.removeChild(this._monitor),e.backDoor(this)},e.MAX_POOL_NUM=5,e._pool_door=[],e}(t.GameObject);t.DoorObject=i,egret.registerClass(i,"d5power.DoorObject")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(){i.call(this)}__extends(e,i);var s=(__define,e);return p=s.prototype,e.getEvent=function(){var t;return t=e._pool_event.length?e._pool_event.pop():new e,t._lock=!1,t._lastCheck=0,t},e.backEvent=function(t){e._pool_event.length<e.MAX_POOL_NUM&&-1==e._pool_event.indexOf(t)&&e._pool_event.push(t)},p.renderAction=function(){t.D5Game.me.timer-this._lastCheck>this._data.checktime&&(this._lastCheck=t.D5Game.me.timer,this._lock?egret.Point.distance(this._data.$pos,t.D5Game.me.player.$pos)>this._data.checksize&&(this._lock=!1):egret.Point.distance(this._data.$pos,t.D5Game.me.player.$pos)<this._data.checksize&&(this._lock=!0,console.log("EventObject script"),this._data.script&&""!=this._data.script&&t.D5Game.me.runScript(this._data.script),1==this._data.checkdel&&this._data.setDeleting(!0)))},p.dispose=function(){this._spriteSheet&&(this._spriteSheet.unlink(),this._spriteSheet=null),this._data=null,this._monitor.texture=null,this._drawAction=null,this.contains(this._monitor)&&this.removeChild(this._monitor),e.backEvent(this)},e.MAX_POOL_NUM=5,e._pool_event=[],e}(t.GameObject);t.EventObject=i,egret.registerClass(i,"d5power.EventObject")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(){i.call(this),this.ID=0,this._playFrame=0,this._alphaCheckTime=0,this._loadID=0}__extends(e,i);var s=__define,n=e;return p=n.prototype,e.getInstance=function(){var t;return t=e._pool.length?e._pool.pop():new e},e.back2pool=function(t){e._pool.length<e.MAX_POOL_NUM&&-1==e._pool.indexOf(t)&&e._pool.push(t)},s(p,"loadID",function(){return this._loadID}),s(p,"inScreen",function(){return this._inScreen}),s(p,"deleteing",function(){return this._deleting}),s(p,"camp",function(){return this._camp}),p.hitTestArea=function(i,e){if(null==this._armature)return!1;var s=t.D5Game.me.map.getScreenPostion(this._data.posX,this._data.posY);return i>=s.x-this._armature.display.width/2&&e>=s.y-this._armature.display.height&&i<s.x+this._armature.display.width/2&&e<=s.y},p.renderMe=function(){this.renderAction(),null!=this._drawAction?this._drawAction():0},s(p,"spriteSheet",function(){return this._spriteSheet}),p.setupData=function(t){this._data=t,RES.getResByUrl(this._data.resStyle+"/skeleton.json",this.onDataComplate,this)},p.onDataComplate=function(t){this._skeletonData=t,RES.getResByUrl(this._data.resStyle+"/texture.json",this.onTextureDataComplete,this)},p.onTextureDataComplete=function(t){this._textureData=t,RES.getResByUrl(this._data.resStyle+"/texture.png",this.onTextureComplete,this)},p.onTextureComplete=function(t){this._texture=t,this.createDB()},p.createDB=function(){var t=new dragonBones.EgretFactory;t.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(this._skeletonData)),t.addTextureAtlas(new dragonBones.EgretTextureAtlas(this._texture,this._textureData)),this._armature=t.buildArmature(this._skeletonData.armature[0].name);var i=this._armature.display;i.scaleX=i.scaleY=1,this.addChild(i),this._armature.animation.gotoAndPlay("action_"+this._data.action,-1,-1,0),dragonBones.WorldClock.clock.contains(this._armature)||(dragonBones.WorldClock.clock.add(this._armature),e.flag||(egret.Ticker.getInstance().register(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3)},this),e.flag=!0))},p.dispose=function(){this._spriteSheet&&(this._spriteSheet.unlink(),this._spriteSheet=null),this._data=null,this._drawAction=null,this._loadID=0,this._armature&&(this.contains(this._armature.display)&&this.removeChild(this._armature.display),dragonBones.WorldClock.clock.contains(this._armature)&&(dragonBones.WorldClock.clock.remove(this._armature),egret.Ticker.getInstance().unregister(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3)},this)),this._armature=null),this._missionIcon&&(this._missionIcon.texture=null,this.contains(this._missionIcon)&&this.removeChild(this._missionIcon)),this._nameShower&&this.contains(this._nameShower)&&(this._nameShower.text="",this.removeChild(this._nameShower)),this._shadow&&this._shadow.graphics.clear(),this._hpBar&&this.contains(this._hpBar)&&this.removeChild(this._hpBar),this._spBar&&this.contains(this._spBar)&&this.removeChild(this._spBar),this._hpBar=null,this._spBar=null,e.back2pool(this)},p.showMissionStatus=function(i){if(null==t.D5Game.me.characterData||null==t.D5Game.me.missionDispatcher)return void console.log("[GameObject] 暂未设置角色信息存储数据。请通过D5Game.me.characterData进行设置。");if(-1==i)return void(this._missionIcon&&this.contains(this._missionIcon)&&this.removeChild(this._missionIcon));this._missionIcon||(this._missionIcon=new egret.Bitmap);var e=t.D5Game.me.characterData.getMissionByIndex(i).missionData;if(e){this._missionIcon.texture=e.type==t.MissionData.TYPE_COMPLATE&&e.check(t.D5Game.me.missionDispatcher)?t.GameObject.MissionOver:e.type==t.MissionData.TYPE_COMPLATE?t.GameObject.MissionOver0:e.check(t.D5Game.me.missionDispatcher)?t.GameObject.MissionStart:t.GameObject.MissionStart0,this.showMissionIcon()}},p.renderAction=function(){t.D5Game.me.timer-this._alphaCheckTime>500&&(this._alphaCheckTime=t.D5Game.me.timer,this._armature&&(this._armature.display.alpha=t.D5Game.me.map.isInAlphaArea(this._data.posX,this._data.posY)?.5:1))},p.setupSkin=function(){this._drawAction=this.drawDB,this._armature&&this._armature.animation.gotoAndPlay("action_"+this._data.action,-1,-1,0),this.showMissionIcon()},p.onSpriteSheepReady=function(){},p.showMissionIcon=function(){null!=this._missionIcon&&(this._missionIcon.y=-this._spriteSheet.frameHeight-this._missionIcon.height,this._missionIcon.x=-(this._missionIcon.width>>1),this.contains(this._missionIcon)||this.addChild(this._missionIcon)),null!=this._data&&null!=this._data.nickname&&(null==this._nameShower&&(this._nameShower=new egret.TextField),this._nameShower.size=12,this._nameShower.textColor=t.D5Game.me.characterData.camp==this._data.camp?10092288:16711680,this._nameShower.text=this._data.nickname,this._nameShower.x=-(this._nameShower.width>>1),this.addChild(this._nameShower))},p.setHpBar=function(t){this._hpBar=t,this.addChild(this._hpBar)},p.updateBar=function(){this._hpBar&&this._hpBar.update(),this._spBar&&this._spBar.update()},p.setSpBar=function(t){this._spBar=t,this.addChild(this._spBar)},p.showPos=function(){},p.drawDB=function(){this._armature&&(this._armature.display.scaleX=this._data.direction<=4?1:-1)},e.flag=!1,e.MAX_POOL_NUM=100,e._pool=[],e}(egret.DisplayObjectContainer);t.GameObjectDB=i,egret.registerClass(i,"d5power.GameObjectDB",["d5power.IGO","d5power.ISpriteSheetWaiter"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(t){function i(e){t.call(this),this._content=e,null==i._sheet&&this.createTexture(),this.buildBitmap()}__extends(i,t);var e=(__define,i);return p=e.prototype,p.createTexture=function(){i._sheet=new egret.SpriteSheet(RES.getRes("number_png"));for(var t,e=0;e<i.NUMBERSTR.length;e++)t=i.NUMBERSTR.charAt(e),i._sheet.createTexture(t,20*e,0,20,20,0,0,20,20)},p.buildBitmap=function(){for(var t,e,s=0;s<this._content.length;s++)e=this._content.charAt(s),t=new egret.Bitmap,t.texture=i._sheet.getTexture(e),t.x=18*s,this.addChild(t);this.cacheAsBitmap=!0},i.NUMBERSTR="-1269345780",i}(egret.Sprite);t.NumberBitmap=i,egret.registerClass(i,"d5power.NumberBitmap")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(){i.call(this)}__extends(e,i);var s=(__define,e);return p=s.prototype,e.getInstance=function(t,i){var s;return s=0==this._pool.length?new e:this._pool.pop(),s.alpha=1,s._scene=t,s.buildBuffer(i),s},e.inPool=function(t){-1==this._pool.indexOf(t)&&this._pool.push(t)},p.buildBuffer=function(i){this._shower&&this._shower.removeChildren(),this._shower=new t.NumberBitmap(i),this.addChild(this._shower),this.xspeed=Math.random()>.5?2:-2,this.yspeed=3},p.setPos=function(t,i){this.x=t,this.y=i,this._scene.addChild(this),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameHander,this)},p.onEnterFrameHander=function(){return this.y-=this.yspeed,this.x+=this.xspeed,this.alpha-.01>0?(this.alpha-=.01,void(this.yspeed-=.08)):(this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameHander,this),this.parent&&this.parent.removeChild(this),void e.inPool(this))},e._pool=new Array,e}(egret.DisplayObjectContainer);t.UFlyFont=i,egret.registerClass(i,"d5power.UFlyFont")}(d5power||(d5power={}));var d5power;!function(t){var i=function(t){function i(i,e,s){void 0===e&&(e=""),void 0===s&&(s=""),t.call(this),this._target=i,""!=e&&this._target.hasOwnProperty(e)&&(this._attName=e),""!=s&&this._target.hasOwnProperty(s)&&(this._attMaxName=s)}__extends(i,t);var e=(__define,i);return p=e.prototype,p.render=function(){},p.clear=function(){},i}(egret.Shape);t.CharacterStuff=i,egret.registerClass(i,"d5power.CharacterStuff")}(d5power||(d5power={}));var d5power;!function(t){var i=function(t){function i(i,e,s,n,r){void 0===n&&(n=1),void 0===r&&(r=10027008),t.call(this,i,e,s),this._size=50,this.color=r,this.y=n,this.x=-(this._size>>1),this.update()}__extends(i,t);var e=(__define,i);return p=e.prototype,p.waitForFly=function(){},p.update=function(){this._lastRender!=this._target[this._attName]&&(this._lastRender=this._target[this._attName],this.graphics.clear(),this.graphics.beginFill(this.color),this.graphics.drawRect(0,0,this._size*this._target[this._attName]/this._target[this._attMaxName],4),this.graphics.endFill(),this.graphics.lineStyle(1),this.graphics.lineTo(this._size,0),this.graphics.lineTo(this._size,4),this.graphics.lineTo(0,4),this.graphics.lineTo(0,0))},i.UP=0,i.DOWN=1,i}(t.CharacterStuff);t.HSpBar=i,egret.registerClass(i,"d5power.HSpBar")}(d5power||(d5power={}));var d5power;!function(t){var i=function(t){function i(i,e,s,n){void 0===s&&(s=null),void 0===n&&(n=null),t.call(this),this.STARTY=80,this.noticeMap=[0,0,0,0,0,0],this.autoShift=0,this.delete_fun=s,this._stayTime=120,this.buildBuffer(e,n);for(var r=!1,a=0,o=this.noticeMap.length;o>a;a++)if(0==this.noticeMap[a]){this.noticeMap[a]=this,this.x=.5*(i.stageWidth-this.width),this.y=this.STARTY+a*(this.height+5),r=!0;break}r||(this.noticeMap[this.autoShift]._stayTime=0,this.noticeMap[this.autoShift]=this,this.x=.5*(i.stageWidth-this.width),this.y=this.STARTY+this.autoShift*(this.height+5),this.autoShift++,this.autoShift>=this.noticeMap.length&&(this.autoShift=0)),i.addChild(this)}__extends(i,t);var e=(__define,i);return p=e.prototype,p.buildBuffer=function(t,i){var e=null==i||null==i.color?65280:i.color,s=1,n=new egret.TextField;n.width=200,n.height=25,n.text=t,n.size=null==i||null==i.size?16:i.size,n.textColor=e,n.textAlign=egret.HorizontalAlign.CENTER,null!=i&&null!=i.bgcolor&&(this.graphics.beginFill(i.bgcolor,null!=i&&null!=i.bgalpha?.6:i.bgalpha),this.graphics.drawRect(0,0,n.width+2*s,n.height+2*s),this.graphics.endFill()),this.addChild(n),this.cacheAsBitmap=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameHander,this)},p.onEnterFrameHander=function(){if(this._stayTime<=0){if(!(this.alpha-.05>0)){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameHander,this),this.parent&&this.parent.removeChild(this),null!=this.delete_fun&&this.delete_fun(this);var t=this.noticeMap.indexOf(this);return void(-1!=t&&(this.noticeMap[t]=0))}return void(this.alpha-=.05)}this._stayTime--},i}(egret.Sprite);t.Notice=i,egret.registerClass(i,"d5power.Notice")}(d5power||(d5power={}));var d5power;!function(t){var i=function(i){function e(t){i.call(this),this._height=120,this._padding=5,this._sayStep=0,this._fontSize=14,this._container=t,this._shower=new egret.TextField,this._shower.size=this._fontSize,this._npcTitle=new egret.TextField,this._npcTitle.size=this._fontSize,this._npcHead=new egret.DisplayObjectContainer}__extends(e,i);var s=(__define,e);return p=s.prototype,p.configDialog=function(i,e,s){t.D5Game.me.player.controller.pause(),null==this._bg&&(this._bg=new egret.Shape,this._bg.graphics.beginFill(0,.4),this._bg.graphics.drawRect(0,0,t.D5Game.me.screenWidth,this._height),this._bg.graphics.endFill(),this.addChild(this._bg),this.y=t.D5Game.me.screenHeight-this._height,this._shower.width=t.D5Game.me.screenWidth-2*this._padding,this._npcTitle.width=this._shower.width,this._npcTitle.height=20,this._npcTitle.y=this._padding,this._shower.height=this._height-3*this._padding-20,this._shower.y=this._npcTitle.y+20+this._padding,this.addChild(this._npcTitle),this.addChild(this._shower)),this._npcNameSrc=e,this._npcHeadSrc=i,this._content=s.split(/[\r|]/g),this._container.addChild(this),this._npcTitle.text=e,this._sayStep=0,this.play(),t.D5Game.me.touchReciver.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickNext,this)},p.dispose=function(i){void 0===i&&(i=null),t.D5Game.me.player.controller.start(),this.parent&&this.parent.removeChild(this),t.D5Game.me.touchReciver.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickNext,this)},p.onClickNext=function(){return this._sayStep++,this._sayStep>=this._content.length?void this.dispose():void this.play()},p.onHead=function(t){this._npcHead.removeChildren(),null!=t&&this._npcHead.addChild(new egret.Bitmap(t))},p.play=function(){var i=this._content[this._sayStep];i=i.replace(/{/g,"<"),i=i.replace(/}/g,">"),"[0]"==i.substr(0,3)&&(i=i.substr(3,i.length-3),this._npcTitle.text=t.D5Game.me.characterData.nickname),this._shower.text=i,console.log("[SimpleDialog] play")},e}(egret.DisplayObjectContainer);t.SimpleDialog=i,egret.registerClass(i,"d5power.SimpleDialog",["d5power.IDialog"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.id=0,this.buy=0,this.sale=0}var i=(__define,t);return p=i.prototype,p.baseFormat=function(t){this.id=parseInt(t.id),this.name=t.name,this.info=t.info,this.buy=parseInt(t.buy_price),this.sale=parseInt(t.sell_price)},t}();t.BaseItemData=i,egret.registerClass(i,"d5power.BaseItemData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.id=0}var i=(__define,t);return p=i.prototype,p.baseFormat=function(t){this.id=parseInt(t.id),this.name=t.name},t}();t.BaseSkillData=i,egret.registerClass(i,"d5power.BaseSkillData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.id=0,this.partArray=new Array}var i=(__define,t);return p=i.prototype,t}();t.ChapterData=i,egret.registerClass(i,"d5power.ChapterData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(){this._chapterID=0,this._partID=0,this._startMission=0,this.camp=0,this.uid=0,this._missionList=[],this._noActiveList=[],this._missionLoadingList=[],this._talkWithNpc=[],this._uiList=[]}var e=__define,s=i;return p=s.prototype,p.addDisplayer=function(t){if(null!=t){if(null==this._waitDispathTimer&&(this._waitDispathTimer=new egret.Timer(500),this._waitDispathTimer.addEventListener(egret.TimerEvent.TIMER,this.onDispathTimer,this)),this._uiList.length>0)for(var i=this._uiList.length-1;i>=0;i--)null==this._uiList[i]&&this._uiList.splice(i,1);-1==this._uiList.indexOf(t)&&this._uiList.push(t)}},p.removeDisplayer=function(t){var i=this._uiList.indexOf(t);-1!=i&&this._uiList.splice(i,1)},p.setuserdataDisplayer=function(t){this._userdataDisplayer=t},p.updateDisplayers=function(){if(this._uiList.length>0)for(var t=0,i=this._uiList.length;i>t;t++)this._uiList[t].update()},p.dispathChange=function(){0==this._uiList.length||this._waitDispathTimer.running||this._waitDispathTimer.start()},p.onDispathTimer=function(){if(this._waitDispathTimer.reset(),this._waitDispathTimer.stop(),trace("延迟更新完成。"),this._uiList.length>0)for(var t=0,i=this._uiList.length;i>t;t++)this._uiList[t].update();this.flushMissionNpc(),this.checkActiveMission()},e(p,"missionNum",function(){return this._missionList.length}),p.onAddMission=function(t,i){this._onAddMission=t,this._onAddMissionThis=i},p.getMissionByIndex=function(t){return t>=this._missionList.length?null:this._missionList[t].missionData},p.getMissionById=function(t){for(var i=this._missionList.length,e=0;i>e;e++){var s=this._missionList[e];if(s.id==t)return s}return null},p.addMissionById=function(t){void 0===t&&(t=0),this.hasMission(t)||-1!=this._missionLoadingList.indexOf(t)||(this._missionLoadingList.push(t),this._missionLoadingList.length>0&&this.loadMissionConfig())},p.setStartMission=function(t){this._startMission=t,this.addMissionById(this._startMission)},e(p,"startMission",function(){return this._startMission}),p.flushMission=function(){for(var t=this._missionList.length,i=0;t>i;i++){this._missionList[i]}},p.checkActiveMission=function(){},p.flushMissionNpc=function(){},p.hasMission=function(t){void 0===t&&(t=0);for(var i=0,e=this._missionList.length;e>i;i++)if(this._missionList[i].id==t)return!0;return!1},p.hasMissionById=function(t){void 0===t&&(t=0);for(var i=this._missionList.length,e=0;i>e;e++){var s=this._missionList[e];if(s.id==t)return!0}return!1},e(p,"lastMissionid",function(){for(var t=0,i=this._missionList.length,e=0;i>e;e++){{this._missionList[e]}return t}}),p.loadMissionConfig=function(){if(!this._missionIsLoading){if(0==this._missionLoadingList.length)return t.D5Game.me.missionLoaded(),void this.updateDisplayers();this._missionIsLoading=!0,console.log("[CharacterData]加载任务："+this._missionLoadingList[0]+".json"),RES.getResByUrl(t.D5Game.RES_SERVER+t.D5Game.ASSET_PATH+"/data/mission/"+this._missionLoadingList[0]+".json",this.onMissionConfigComplate,this)}},p.onMissionConfigComplate=function(i){this._missionIsLoading=!1;var e=new t.MissionData;e.formatFromJson(i),this._missionList.push(e),this._missionLoadingList.shift(),this.loadMissionConfig(),null!=this._onAddMission&&this._onAddMission(e.id)},p.deleteMission=function(t){this._missionList.splice(this._missionList.indexOf(t),1)},p.addMission=function(){},p.hasItemNum=function(t){return void 0===t&&(t=0),0},p.hasTalkedWith=function(t){return void 0===t&&(t=0),!0},p.killMonseterNum=function(t){return void 0===t&&(t=0),0},p.hasBuff=function(t){return void 0===t&&(t=0),!1},p.hasEqu=function(t){return void 0===t&&(t=0),!1},p.hasSkill=function(t,i){return void 0===i&&(i=0),!1},p.hasSkin=function(){return!1},p.userPro=function(t,i){return void 0===i&&(i=0),!1},p.getItem=function(t,i,e,s){return void 0===e&&(e=0),void 0===s&&(s=!1),!0},p.addPro=function(){return!0},p.getExp=function(t){void 0===t&&(t=0)},p.delItem=function(){return!1},p.getMoney=function(t){return 0>t&&this._money<-t?!1:(this._money+=t,null!=this._userdataDisplayer&&this._userdataDisplayer.update(),!0)},p.hasChecker=function(t){return void 0===t&&(t=0),!1},p.publicCheck=function(){return!1},p.checkSkillByID=function(){return null},p.check=function(){},i}();t.CharacterData=i,egret.registerClass(i,"d5power.CharacterData",["d5power.ICharacterData","d5power.IMissionDispatcher"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(){this._speed=3,this._uid=0,this._work=0,this._camp=0,this._hp=0,this._isDB=0,this._checktime=0,this._checksize=0,this._checkdel=0,this.inG=!0,this.speedX=0,this.speedY=0,this._zOrderF=0,this._pos=new egret.Point}var e=__define,s=i;return p=s.prototype,i.initPool=function(t){if(void 0===t&&(t=400),null!=i._pool)throw new Error("[GOData] initPool just can run one time.");i._poolNum=t,i._pool=new Array;for(var e=0;e<i._poolNum;e++)i._pool.push(new i)},i.getInstance=function(){return i._pool.length>0?i._pool.pop():new i},i.back2pool=function(t){i._pool.length<i._poolNum&&-1==i._pool.indexOf(t)&&i._pool.push(t)},p.loadMission=function(){if(t.D5Game.me.characterData){var i,e=t.D5Game.me.characterData.missionNum;this._missionIndex=-1,this._missionIndexList=new Array;for(var s=0;e>s;s++)i=t.D5Game.me.characterData.getMissionByIndex(s).missionData,(0==i.type&&i.npc_startId==this._uid||i.type>0&&i.npc_CompleteId==this._uid)&&(-1==this._missionIndex&&(this._missionIndex=s),this._missionIndexList.push(s));-1==this._missionIndex&&this._missionIndexList.length>0&&(this._missionIndex=this._missionIndexList[0]),this._displayer&&this.displayer.showMissionStatus(this._missionIndex)}},p.run=function(){var i,e,s=t.D5Game.me.map.width,n=t.D5Game.me.map.height;if(this._pos.x+=this.speedX,this._pos.y+=this.speedY,t.D5Game.me.camera.focus==this)i=this._pos.x<t.D5Game.me.screenWidth>>1?this._pos.x:t.D5Game.me.screenWidth>>1,e=this._pos.y<t.D5Game.me.screenHeight>>1?this._pos.y:t.D5Game.me.screenHeight>>1,i=this._pos.x>s-(t.D5Game.me.screenWidth>>1)?this._pos.x-(s-t.D5Game.me.screenWidth):i,e=this._pos.y>n-(t.D5Game.me.screenHeight>>1)?this._pos.y-(n-t.D5Game.me.screenHeight):e;else{var r=t.D5Game.me.map.getScreenPostion(this._pos.x,this._pos.y);i=r.x,e=r.y}this._displayer&&(this._displayer.x=parseInt(i),this._displayer.y=parseInt(e)),this._controller&&this._controller.run()},p.setAction=function(t){this._action=t,null!=this._resStyle&&this.setRespath(this._resStyle+"/"+t)},e(p,"action",function(){return this._action}),p.setZOrderF=function(t){this._zOrderF=t},p.zOrderF=function(){return this._zOrderF},e(p,"zOrder",function(){return this.posY+this._zOrderF}),p.setDirection=function(t){this._direction=t},e(p,"direction",function(){return this._direction}),p.setPos=function(t,i){this._pos.x=t,this._pos.y=i},e(p,"speed",function(){return this._speed}),p.setSpeed=function(t){this._speed=t},e(p,"$pos",function(){return this._pos}),e(p,"posX",function(){return this._pos.x}),e(p,"posY",function(){return this._pos.y}),p.setController=function(t){this._controller=t},e(p,"controller",function(){return this._controller}),p.setRespath=function(t){this._respath=t,null!=t&&""!=t&&this._displayer&&this._displayer.setupSkin(this._respath)},e(p,"respath",function(){return this._respath}),p.setResStyle=function(i){this._resStyle=i,this.setAction(t.Actions.Wait)},e(p,"resStyle",function(){return this._resStyle}),p.setLink=function(t,i,e){this._link_map=t,this._link_posx=i,this._link_posy=e},e(p,"linkMap",function(){return this._link_map
}),e(p,"linkPosx",function(){return this._link_posx}),e(p,"linkPosy",function(){return this._link_posy}),p.setNickname=function(t){this._nickname=t},e(p,"nickname",function(){return this._nickname}),p.setWork=function(t){this._work=t},e(p,"work",function(){return this._work}),p.isNpc=function(){return this._work==i.WORK_NPC},p.isDoor=function(){return this._work==i.WORK_DOOR},p.dispose=function(){this._controller&&this._controller.dispose(),this._controller=null,this._deleting=!1,this._work=i.WORK_NORMAL,this._inScreen=!1,this._nickname=null,this._respath=null,this._resStyle=null,this.$pos.x=0,this.$pos.y=0,this.setJob(0,"","0"),this.setDisplayer(null),this.setAI(null),this.setUid(0),i.back2pool(this)},p.setInScreen=function(t){this._inScreen=t},e(p,"inScreen",function(){return this._inScreen}),p.setCamp=function(t){this._camp=t},e(p,"camp",function(){return this._camp}),e(p,"deleting",function(){return this._deleting}),p.setDeleting=function(t){this._deleting=t},p.setDisplayer=function(t){null!=this._displayer&&null==t&&this._displayer.dispose(),this._displayer=t,this._displayer&&(this._displayer.setupData(this),null!=this.respath&&""!=this.respath&&this._displayer.setupSkin(this.respath))},e(p,"displayer",function(){return this._displayer}),p.setAI=function(t){this._ai=t},e(p,"ai",function(){return this._ai}),p.setUid=function(t){this._uid=t},e(p,"uid",function(){return this._uid}),p.setSay=function(t){this._say=t},e(p,"say",function(){var i=-1==this._missionIndex?null:t.D5Game.me.characterData.getMissionByIndex(this._missionIndex).missionData;return null==i?this._say:i.npc_said}),p.setScript=function(t){this._script=t},e(p,"script",function(){return this._script}),e(p,"missionIndexList",function(){return this._missionIndexList}),e(p,"missionIndex",function(){return this._missionIndex}),p.setJob=function(t,i,e){this._job_type=t,this._job_value=i,this._job_num=e},e(p,"job_type",function(){return this._job_type}),e(p,"job_value",function(){return this._job_value}),e(p,"job_number",function(){return this._job_num}),p.renderMe=function(){this.displayer.renderMe()},p.setHp=function(t){0>t&&(t=0),this._hp=t>this._maxHp?this._maxHp:t},e(p,"hp",function(){return this._hp}),p.setMaxHp=function(t){this._maxHp=t,this._hp=t},e(p,"maxHp",function(){return this._maxHp}),p.setSp=function(t){0>t&&(t=0),this._sp=t>this._maxSp?this._maxSp:t},e(p,"sp",function(){return this._sp}),p.setMaxSp=function(t){this._maxSp=t,this._sp=t},e(p,"maxSp",function(){return this._maxSp}),p.setMonsterid=function(t){this._monsterid=t},e(p,"monsterid",function(){return this._monsterid}),p.setIsDB=function(t){this._isDB=t},e(p,"isDB",function(){return this._isDB}),p.setChecktime=function(t){this._checktime=t},e(p,"checktime",function(){return this._checktime}),p.setChecksize=function(t){this._checksize=t},e(p,"checksize",function(){return this._checksize}),p.setCheckdel=function(t){this._checkdel=t},e(p,"checkdel",function(){return this._checkdel}),i.WORK_NORMAL=0,i.WORK_NPC=1,i.WORK_DOOR=2,i.WORK_MONSTER=3,i.WORK_EVENT=4,i.JOB_COLLECTION=1,i.JOB_SHOP=2,i.JOB_CHANGE_MAP=3,i.JOB_COMPOSE=4,i}();t.GOData=i,egret.registerClass(i,"d5power.GOData",["d5power.IGD"])}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.name="",this.skin=""}var i=(__define,t);return p=i.prototype,p.format=function(t){this.id=parseInt(t.id),this.name=t.name,this.skin=t.skin},p.toString=function(){return"阵营["+this.id+"]"+name},t}();t.JobData=i,egret.registerClass(i,"d5power.JobData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.type=0}var i=__define,e=t;return p=e.prototype,i(p,"Type",function(){return this.type}),i(p,"Value",function(){return this.value}),i(p,"Num",function(){return this.num}),p.format=function(t,i,e){this.type=t,this.value=i,this.num=e},p.toString=function(){return"类型："+this.type+"值："+this.value+"数量："+this.num},t}();t.MissionBlock=i,egret.registerClass(i,"d5power.MissionBlock")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(t){void 0===t&&(t=0),this._actionType=0,this._type=0,this._id=0,this._isstart=!1,this._iscomplate=!1,this._isactive=!1,this._id=t}var e=__define,s=i;return p=s.prototype,p.setNode=function(t){this._node=t},e(p,"node",function(){return this._node}),p.formatFromJson=function(i){var e;this._need=[],this._give=[],this._active=[],this._name=i.name,this._actionType=i.type,this._info=i.info,this._npc_startId=i.npcStartId,this._npc_CompleteId=i.npcCompleteId,this._id=i.id,this._npc_said=i.npcSaid,this._startScript=i.startScript,this._complate_script=i.completeScript,this._uncompDialog=i.uncompDialog,this._completeDialog=i.completeDialog;var s,n;if(i.need)for(n=0;n<i.need.length;n++)s=i.need[n],e=new t.MissionBlock,e.type=parseInt(s.type),e.value=s.value,e.num=s.num,this._active.push(e);var s;if(i.give)for(n=0;n<i.give.length;n++)s=i.give[n],e=new t.MissionBlock,e.type=parseInt(s.type),e.value=s.value,e.num=s.num,this._give.push(e);var s;if(i.complete)for(n=0;n<i.complete.length;n++)s=i.complete[n],e=new t.MissionBlock,e.type=parseInt(s.type),e.value=s.value,e.num=s.num,this._need.push(e)},e(p,"complate_script",function(){return this._complate_script}),e(p,"startScript",function(){return this._startScript}),e(p,"actionType",function(){return this._actionType}),p.setType=function(t){this._type=t},e(p,"type",function(){return this._type}),e(p,"name",function(){return this._name}),e(p,"id",function(){return this._id}),e(p,"info",function(){return this._info}),e(p,"npc_said",function(){return this._npc_said}),e(p,"uncompDialog",function(){return this._uncompDialog}),e(p,"completeDialog",function(){return this._completeDialog}),e(p,"npc_startId",function(){return this._npc_startId}),e(p,"npc_CompleteId",function(){return this._npc_CompleteId}),e(p,"need",function(){return this._need}),e(p,"active",function(){return this._active}),e(p,"give",function(){return this._give}),e(p,"giveString",function(){for(var i="",e=this.give.length,s=0;e>s;s++){var n=this.give[s];i+=t.MissionNR.getChinese(n.type)+"x"+n.num}return i}),e(p,"needString",function(){for(var i="",e=this._need.length,s=0;e>s;s++){var n=this._need[s];i+=t.MissionNR.getChinese(n.type)+"()"}return i}),e(p,"isComplate",function(){return this._iscomplate}),e(p,"isActive",function(){return this._isactive}),p.addNeed=function(t){null==this._need&&(this._need=[]),(0!=t.type||null!=t.value)&&this._need.push(t)},p.addGive=function(t){null==this._give&&(this._give=[]),(0!=t.type||null!=t.value)&&this._give.push(t)},p.check=function(i){if(this._iscomplate=!0,null!=this._need)for(var e=this._need.length,s=0;e>s;s++){var n=this._need[s];switch(n.type){case t.MissionNR.N_ITEM_NEED:case t.MissionNR.N_ITEM_TACKED:this._iscomplate=this._iscomplate&&i.hasItemNum(parseInt(n.value))>=parseInt(n.num);break;case t.MissionNR.N_MONSTER_KILLED:this._iscomplate=this._iscomplate&&i.killMonseterNum(parseInt(n.value))>=parseInt(n.num);break;case t.MissionNR.N_PLAYER_PROP:this._iscomplate=this._iscomplate&&i.userPro(n.value,parseInt(n.num));break;case t.MissionNR.N_MISSION:this._iscomplate=this._iscomplate&&i.hasMission(parseInt(n.value));break;case t.MissionNR.N_TALK_NPC:this._iscomplate=this._iscomplate&&i.hasTalkedWith(parseInt(n.value));break;case t.MissionNR.N_BUFF:this._iscomplate=this._iscomplate&&i.hasBuff(parseInt(n.value));break;case t.MissionNR.N_EQU:this._iscomplate=this._iscomplate&&i.hasEqu(parseInt(n.value));break;case t.MissionNR.N_SKILL:this._iscomplate=this._iscomplate&&i.hasSkill(parseInt(n.value),0);break;case t.MissionNR.N_SKILL_LV:this._iscomplate=this._iscomplate&&i.hasSkill(parseInt(n.value),parseInt(n.num));break;case t.MissionNR.N_SKIN:this._iscomplate=this._iscomplate&&i.hasSkin(n.value);break;default:i.hasChecker(n.type)&&(this._iscomplate=this._iscomplate&&i.publicCheck(n.type,n.value,n.num))}}return this._iscomplate},p.checkActive=function(i){if(this._isactive=!0,null!=this._active)for(var e=this._active.length,s=0;e>s;s++){var n=this._active[s];switch(n.type){case t.MissionNR.N_ITEM_NEED:case t.MissionNR.N_ITEM_TACKED:this._isactive=this._isactive&&i.hasItemNum(parseInt(n.value))>=parseInt(n.num);break;case t.MissionNR.N_MONSTER_KILLED:this._isactive=this._isactive&&i.killMonseterNum(parseInt(n.value))>=parseInt(n.num);break;case t.MissionNR.N_PLAYER_PROP:this._isactive=this._isactive&&i.userPro(n.value,parseInt(n.num));break;case t.MissionNR.N_MISSION:this._isactive=this._isactive&&i.hasMission(parseInt(n.value));break;case t.MissionNR.N_TALK_NPC:this._isactive=this._isactive&&i.hasTalkedWith(parseInt(n.value));break;case t.MissionNR.N_BUFF:this._isactive=this._isactive&&i.hasBuff(parseInt(n.value));break;case t.MissionNR.N_EQU:this._isactive=this._isactive&&i.hasEqu(parseInt(n.value));break;case t.MissionNR.N_SKILL:this._isactive=this._isactive&&i.hasSkill(parseInt(n.value),0);break;case t.MissionNR.N_SKILL_LV:this._isactive=this._isactive&&i.hasSkill(parseInt(n.value),parseInt(n.num));break;case t.MissionNR.N_SKIN:this._isactive=this._isactive&&i.hasSkin(n.value);break;default:i.hasChecker(n.type)&&(this._isactive=this._isactive&&i.publicCheck(n.type,n.value,n.num))}}return this._isactive},p.complate=function(e,s){if(!this.check(e))return!1;if(this._actionType!=i.ACTIONTYPE_AGAIN?t.D5Game.me.characterData.deleteMission(s):(this._isactive=!1,this._iscomplate=!1,this._type=0),t.D5Game.me.characterData.addMission(s),t.D5Game.me.characterData.check(),null!=this._need)for(var n=this._need.length,r=0;n>r;r++){var a=this._need[r];switch(a.type){case t.MissionNR.N_ITEM_NEED:t.D5Game.me.characterData.delItem(parseInt(a.value),parseInt(a.num))}}if(null!=this._give)for(var o=this._give.length,h=0;o>h;h++){var l=this._give[h];i.reward(l,e)}return!0},i.reward=function(i,e){switch(i.type){case t.MissionNR.R_ITEM:e.getItem(i.value,i.num,0,!1);break;case t.MissionNR.R_MONEY:e.getMoney(parseInt(i.value)),t.D5Game.me.missionLoaded();break;case t.MissionNR.R_EXP:e.getExp(parseInt(i.value));break;case t.MissionNR.R_MISSION:t.D5Game.me.characterData.addMissionById(parseInt(i.Value))}},p.toString=function(){return"任务名："+this._name+"\n任务编号："+this._id+"\n任务类型："+this._type+"\n任务说明:"+this._info},i.TYPE_GET=1,i.TYPE_COMPLATE=2,i.ACTIONTYPE_TRUNK=0,i.ACTIONTYPE_BRANCHES=1,i.ACTIONTYPE_AGAIN=2,i.GIVE=0,i.MISS=1,i}();t.MissionData=i,egret.registerClass(i,"d5power.MissionData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(){this.id=0,this.chapterId=0,this.partId=0,this.missionId=0}var e=__define,s=i;return p=s.prototype,p.format=function(i){this.id=parseInt(i.id),this.childs=i.node,this.missionId=parseInt(i.missionId),this._missionData=t.D5ConfigCenter.my.getMissionData(this.missionId),this._missionData.setNode(this)},e(p,"missionData",function(){return this._missionData}),i}();t.MissionNode=i,egret.registerClass(i,"d5power.MissionNode")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,t.addCostomDefine=function(i){return 2!=i.length?"无效的配置数据":parseInt(i[0])<=t.SAVE_KEY?t.SAVE_KEY+"以内为D5Rpg保留条件ID":(t.COSTOM_DEFINE.push(i),"TRUE")},t.getChinese=function(i){switch(void 0===i&&(i=0),i){case t.N_MONSTER_KILLED:return"杀死怪物";case t.N_ITEM_NEED:return"拥有道具（扣除）";case t.N_ITEM_TACKED:return"拥有道具（不扣除）";case t.N_MISSION:return"拥有任务";case t.N_PLAYER_PROP:return"玩家属性达到";case t.N_TALK_NPC:return"与NPC对话";case t.N_SKILL_LV:return"技能等级达到";case t.N_EQU:return"需要装备";case t.N_SKIN:return"需要皮肤";case t.N_SKILL:return"需要学会技能";case t.N_BUFF:return"需要BUFF状态";case t.R_ITEM:return"奖励道具";case t.R_MONEY:return"奖励游戏币";case t.R_EXP:return"奖励经验";case t.R_MISSION:return"奖励任务";default:for(var e=t.COSTOM_DEFINE.length,s=0;e>s;s++){var n=t.COSTOM_DEFINE[s];if(n[0]==i)return n[1]}}return"NULL"},t.SAVE_KEY=200,t.N_R_LINE=100,t.N_MONSTER_KILLED=0,t.N_ITEM_TACKED=1,t.N_ITEM_NEED=2,t.N_MISSION=3,t.N_PLAYER_PROP=4,t.N_TALK_NPC=5,t.N_SKILL_LV=6,t.N_SKIN=7,t.N_EQU=9,t.N_SKILL=10,t.N_BUFF=11,t.N_MONEY=12,t.N_MARK=13,t.N_MONEY_KEEP=14,t.R_ITEM=100,t.R_MONEY=101,t.R_EXP=102,t.R_MISSION=103,t.R_PLAYER_PROP=104,t.COSTOM_DEFINE=new Array,t}();t.MissionNR=i,egret.registerClass(i,"d5power.MissionNR")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,p.formatObject=function(t){this.id=t.id,this.name=t.name,this.lv=t.lv,this.skin=t.skin,this.isDB=t.isDB},p.format=function(t){this.id=parseInt(t.id),this.name=String(t.name),this.lv=parseInt(t.lv),this.skin=String(t.skin),this.isDB=parseInt(t.isDB)},t}();t.MonsterConfData=i,egret.registerClass(i,"d5power.MonsterConfData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,p.format=function(t){this.id=parseInt(t.id),this.stay=0==parseInt(t.stay)?!1:!0,this.walk_round=parseInt(t.walk_round),this.flush_num=parseInt(t.flush_num),this.flush_dis=parseInt(t.flush_dis),this.relive=parseInt(t.relive),this.campset=parseInt(t.camp),this.autoAtk=0==parseInt(t.autoAtk)?!1:!0,this.posx=parseInt(t.posx),this.posy=parseInt(t.posy)},t}();t.MonsterFlushData=i,egret.registerClass(i,"d5power.MonsterFlushData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,p.format=function(t){this.id=parseInt(t.id),this.name=t.name,this.skin=t.skin,this.head=t.head,this.inmap=parseInt(t.inmap)},p.toString=function(){return"npc["+this.id+"]"+this.name+"[Ƥ��]"+this.skin+"[���ڵ�ͼ]"+this.inmap},t}();t.NpcData=i,egret.registerClass(i,"d5power.NpcData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.id=0,this.tree=new Object}var i=(__define,t);return p=i.prototype,t}();t.PartData=i,egret.registerClass(i,"d5power.PartData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.name="",this.icon=""}var i=(__define,t);return p=i.prototype,p.format=function(t){this.id=parseInt(t.id),this.posX=parseInt(t.x),this.posY=parseInt(t.y),this.icon=t.icon,this.name=t.name},p.toString=function(){return"�³���["+this.id+"]"+this.name},t}();t.SceneData=i,egret.registerClass(i,"d5power.SceneData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){throw new Error("Base64 class is static container only")}var i=(__define,t);return p=i.prototype,t.encode=function(i){var e=new egret.ByteArray;return e.writeUTFBytes(i),e.endian=egret.Endian.LITTLE_ENDIAN,t.encodeByteArray(e)},t.decodeToArray=function(i,e){var s=new Array,n=t.decodeToByteArray(i);for(n.endian=egret.Endian.LITTLE_ENDIAN;n.bytesAvailable;){for(var r=[],a=0;e>a;a++){var o=n.readInt();r.push(o)}s.push(r)}return s},t.encodeByteArray=function(i){var e,s="",n=new Array(4);for(i.position=0;i.bytesAvailable>0;){e=new Array;for(var r=0;3>r&&i.bytesAvailable>0;r++)e[r]=i.readUnsignedByte();n[0]=(252&e[0])>>2,n[1]=(3&e[0])<<4|e[1]>>4,n[2]=(15&e[1])<<2|e[2]>>6,n[3]=63&e[2];for(var a=e.length;3>a;a++)n[a+1]=64;for(var o=0;o<n.length;o++)s+=t.BASE64_CHARS.charAt(n[o])}return s},t.decode=function(i){var e=t.decodeToByteArray(i);return e.endian=egret.Endian.LITTLE_ENDIAN,e.readUTFBytes(e.length)},t.decodeToByteArray=function(i){for(var e=new egret.ByteArray,s=new Array(4),n=new Array(3),r=0;r<i.length;r+=4){for(var a=0;4>a&&r+a<i.length;a++)s[a]=t.BASE64_CHARS.indexOf(i.charAt(r+a));n[0]=(s[0]<<2)+((48&s[1])>>4),n[1]=((15&s[1])<<4)+((60&s[2])>>2),n[2]=((3&s[2])<<6)+s[3];for(var o=0;o<n.length&&64!=s[o+1];o++)e.writeByte(n[o])}return e.position=0,e},t.BASE64_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t}();t.Base64=i,egret.registerClass(i,"d5power.Base64")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(t,e){this.x=0,this.y=0,this.width=0,this.height=0,this.compressed=!1,this.map=e,this.name=t.name,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.visible=!t.visible||0!=t.visible,this.opacity=t.opacity;var s;this.tileGIDs=[],this.encoding=t.encoding;var n;if(""==t.encoding)for(var r=this.width,a=-1,o=t.tile.length,h=0;o>h;h++){s=t.tile[h],++r>=this.width&&(this.tileGIDs[++a]=[],r=0);var l=s.gid;this.tileGIDs[a].push(l)}else if("csv"==t.encoding)n=t.data,this.tileGIDs=i.csvToArray(n,this.width);else if("base64"==t.encoding)if(n=t.data,"zlib"==t.compression)this.compressed=!0;else if(0!=t.compression.length())throw"TmxLayer - data compression type not supported!"}var e=(__define,i);return p=e.prototype,p.toJson=function(){var t=new Object;if(t.name=this.name,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.visible=this.visible,t.opacity=this.opacity,t.encoding=this.encoding,""==this.encoding){for(var i=new Array,e=0;e<this.tileGIDs.length;e++)for(var s=new Array(this.tileGIDs[e]),n=s.length,r=0;n>r;r++){var a=new Object;a.gid=s[r],i.push(a)}t.tile=i}else"csv"==this.encoding?t.data=this.arrayToCsv(this.tileGIDs):"base64"==this.encoding&&(t.data=this.arrayToBase64(this.tileGIDs,this.width,this.compressed));return t},p.arrayToString=function(){for(var t="",i=0;i<this.tileGIDs.length;i++)for(var e=new Array(this.tileGIDs[i]),s=e.length,n=0;s>n;n++)0!=e[n]&&(t+=e[n]);return t},i.csvToArray=function(t,i){void 0===i&&(i=0);for(var e=[],s=t.split("\n"),n=s.length,r=0;n>r;r++){for(var a=s[r],o=[],h=a.split(",",i),l=h.length,p=0;l>p;p++){var _=h[p];o.push(parseInt(_))}e.push(o)}return e},p.arrayToCsv=function(t){for(var i="",e=0;e<t.length;e++){for(var s=t[e],n=0;n<s.length;n++)i+=n<s.length-1?s[n]+",":s[n];i+="\n"}return i},p.arrayToBase64=function(i){var e="",s=new egret.ByteArray;s.endian=egret.Endian.LITTLE_ENDIAN;for(var n=0;n<i.length;n++)for(var r=i[n],a=0;a<r.length;a++)s.writeInt(r[a]);return s.position=0,e=t.Base64.encodeByteArray(s)},i.base64ToArray=function(i,e){var s=[],n=t.Base64.decodeToByteArray(i);for(n.endian=egret.Endian.LITTLE_ENDIAN,console.log(n.bytesAvailable);n.bytesAvailable;){for(var r=[],a=0;e>a;a++){var o=n.readInt();r.push(o)}s.push(r)}return s},p.testDecode=function(){return""},i.base64ToByteArray=function(t){for(var e=new egret.ByteArray,s=[],n=0;n<i.BASE64_CHARS.length;n++)s[i.BASE64_CHARS.charCodeAt(n)]=n;for(var r=0;r<t.length-3;r+=4){var a=s[t.charCodeAt(r)],o=s[t.charCodeAt(r+1)],h=s[t.charCodeAt(r+2)],l=s[t.charCodeAt(r+3)];64>o&&e.writeByte((a<<2)+((48&o)>>4)),64>h&&e.writeByte(((15&o)<<4)+((60&h)>>2)),64>l&&e.writeByte(((3&h)<<6)+l)}return e.position=0,e},i.BASE64_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i}();t.TiledLayer=i,egret.registerClass(i,"d5power.TiledLayer")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function i(){this.width=0,this.height=0,this.tileWidth=0,this.tileHeight=0,this.version=0,this.nextobjectid=0,this.layers={},this.tileSets={},this.objectGroups={}}var e=(__define,i);return p=e.prototype,p.format=function(i){this.width=parseInt(i.width),this.height=parseInt(i.height),this.tileWidth=parseInt(i.tilewidth),this.tileHeight=parseInt(i.tileheight),this.version=parseInt(i.version),this.orientation=i.orientation,this.renderorder=i.renderorder,this.nextobjectid=parseInt(i.nextobjectid);var e=null;this.imgLib=new Array;for(var s=i.tilesets.length,n=0;s>n;n++){e=i.tilesets[n];var r=new t.TiledTileSet(e,this);this.tileSets[e.name]=r,this.imgLib.push(r)}this.layers_ordered=new Array;for(var a=i.layers.length,o=0;a>o;o++)e=i.layers[o],this.layers[e.name]=new t.TiledLayer(e,this),this.layers_ordered.push(e.name)},p.getTileSet=function(t){return this.tileSets[t]},p.getLayer=function(t){return this.layers[t]},p.getGidOwner=function(t){void 0===t&&(t=0);for(var i=this.tileSets.length,e=0;i>e;e++){var s=this.tileSets[e];if(s.hasGid(t))return s}return null},i}();t.TiledMap=i,egret.registerClass(i,"d5power.TiledMap")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){}var i=(__define,t);return p=i.prototype,t.setupResLib=function(i,e,s){if(this._bitmap=e,t._bitmap){var n,r=new egret.SpriteSheet(e);n=t._resourceLib[i]?t._resourceLib[i]:new Array;for(var a=0,o=0;o<s.numCols;o++)for(var h=0;h<s.numRows;h++){r.createTexture(i+s.firstGID+a,h*s.tileWidth,o*s.tileHeight,s.tileWidth,s.tileHeight);var l=r.getTexture(i+s.firstGID+a);n[s.firstGID+a]=l,a++}t._resourceLib[i]=n}},t.getResource=function(i,e){if(t._resourceLib[i]){var s,n=t._resourceLib[i];return s=n[e]?n[e]:null}return null},t._resourceLib={},t}();t.TiledResourceData=i,egret.registerClass(i,"d5power.TiledResourceData")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(t,i){this._tileProps=[],this._image=null,this.firstGID=0,this.tileWidth=0,this.tileHeight=0,this.spacing=0,this.margin=0,this.imageSource="",this.imageheight=0,this.imagewidth=0,this.numTiles=16777215,this.numRows=1,this.numCols=1,this.firstGID=t.firstgid,this.imageSource=t.image,this.map=i,this.name=t.name,this.tileWidth=t.tilewidth,this.tileHeight=t.tileheight,this.imagewidth=t.imagewidth,this.imageheight=t.imageheight,this.spacing=t.spacing,this.margin=t.margin,this.numTiles=t.tilecount,this.numRows=Math.ceil(this.imagewidth/this.tileWidth),this.numCols=Math.ceil(this.imageheight/this.tileHeight)}var i=__define,e=t;return p=e.prototype,p.toJson=function(){var t=new Object;t.firstGID=this.firstGID,t.imageSource=this.imageSource,t.name=this.name,t.tileWidth=this.tileWidth,t.tileHeight=this.tileHeight,t.spacing=this.spacing,t.margin=this.margin;{var i=new Array;this._tileProps.length}return t.tile=i,t},i(p,"image",function(){return this._image},function(t){this._image=t,this.numCols=Math.floor(t.textureWidth/this.tileWidth),this.numRows=Math.floor(t.textureHeight/this.tileHeight),this.numTiles=this.numRows*this.numCols}),p.hasGid=function(t){return void 0===t&&(t=0),t>=this.firstGID&&t<this.firstGID+this.numTiles},p.fromGid=function(t){return void 0===t&&(t=0),t-this.firstGID},p.toGid=function(t){return void 0===t&&(t=0),this.firstGID+t},p.getRect=function(t){return void 0===t&&(t=0),new egret.Rectangle((t-this.firstGID)%this.numCols*this.tileWidth,Math.floor((t-this.firstGID)/this.numCols)*this.tileHeight,this.tileWidth,this.tileHeight)},t}();t.TiledTileSet=i,egret.registerClass(i,"d5power.TiledTileSet")}(d5power||(d5power={}));var d5power;!function(t){var i=function(){function t(){this.name=""}var i=(__define,t);return p=i.prototype,p.format=function(t){this.field=t.field,this.name=t.name},t}();t.UserProData=i,egret.registerClass(i,"d5power.UserProData")}(d5power||(d5power={}));